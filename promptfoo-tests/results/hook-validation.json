{
  "evalId": "eval-oxj-2025-11-21T12:15:57",
  "results": {
    "version": 3,
    "timestamp": "2025-11-21T12:15:57.454Z",
    "prompts": [
      {
        "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
        "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
        "id": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "provider": "anthropic:claude-3-5-haiku-20241022",
        "metrics": {
          "score": 3.888888888888889,
          "testPassCount": 4,
          "testFailCount": 0,
          "testErrorCount": 0,
          "assertPassCount": 16,
          "assertFailCount": 0,
          "totalLatencyMs": 5084,
          "tokenUsage": {
            "prompt": 3498,
            "completion": 94,
            "cached": 0,
            "total": 3592,
            "numRequests": 4,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.0031744
        }
      }
    ],
    "results": [
      {
        "cost": 0.0007800000000000001,
        "gradingResult": {
          "pass": true,
          "score": 0.9722222222222222,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": true,
              "score": 0.888888888888889,
              "reason": "F1: 0.89, Precision: 0.80, Recall: 1.00 | Expected: [postgres-pro, backend-developer, code-reviewer, research-analyst] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2392ccc0-2139-467d-a297-46d4110e7b85",
        "latencyMs": 1209,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,code-reviewer,research-analyst,debugger",
          "tokenUsage": {
            "total": 891,
            "prompt": 870,
            "completion": 21
          },
          "finishReason": "stop",
          "cost": 0.0007800000000000001
        },
        "score": 0.9722222222222222,
        "success": true,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query",
            "expected_agents": "postgres-pro,backend-developer,code-reviewer,research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 0,
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "postgres-pro,backend-developer,code-reviewer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.0008088,
        "gradingResult": {
          "pass": true,
          "score": 0.9722222222222222,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": true,
              "score": 0.888888888888889,
              "reason": "F1: 0.89, Precision: 0.80, Recall: 1.00 | Expected: [eventsourcing-expert, backend-developer, microservices-architect, python-pro] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "9dfa123b-9fb7-471d-93c4-95503ffb8e42",
        "latencyMs": 1263,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "total": 903,
            "prompt": 876,
            "completion": 27
          },
          "finishReason": "stop",
          "cost": 0.0008088
        },
        "score": 0.9722222222222222,
        "success": true,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system",
            "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 1,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.0007944,
        "gradingResult": {
          "pass": true,
          "score": 0.9722222222222222,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": true,
              "score": 0.888888888888889,
              "reason": "F1: 0.89, Precision: 0.80, Recall: 1.00 | Expected: [datadog-specialist, python-pro, backend-developer, research-analyst] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d1159080-106a-46a6-9d27-9d453bb8ae3e",
        "latencyMs": 1514,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "total": 901,
            "prompt": 878,
            "completion": 23
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.9722222222222222,
        "success": true,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app",
            "expected_agents": "datadog-specialist,python-pro,backend-developer,research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 2,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "datadog-specialist,python-pro,backend-developer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.0007912,
        "gradingResult": {
          "pass": true,
          "score": 0.9722222222222222,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": true,
              "score": 0.888888888888889,
              "reason": "F1: 0.89, Precision: 0.80, Recall: 1.00 | Expected: [test-automator, qa-expert, backend-developer, code-reviewer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "0a2096f2-690a-4056-9bdc-2e814de48201",
        "latencyMs": 1098,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "total": 897,
            "prompt": 874,
            "completion": 23
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.9722222222222222,
        "success": true,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application",
            "expected_agents": "test-automator,qa-expert,backend-developer,code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 3,
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "test-automator,qa-expert,backend-developer,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      }
    ],
    "stats": {
      "successes": 4,
      "failures": 0,
      "errors": 0,
      "tokenUsage": {
        "prompt": 3498,
        "completion": 94,
        "cached": 0,
        "total": 3592,
        "numRequests": 4,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      }
    }
  },
  "config": {
    "tags": {},
    "description": "Agent Discovery Hook - LLM Matching Evaluation",
    "prompts": [
      "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
    ],
    "providers": [
      {
        "id": "anthropic:claude-3-5-haiku-20241022",
        "config": {
          "temperature": 0,
          "max_tokens": 100
        }
      }
    ],
    "tests": [
      {
        "description": "PostgreSQL query optimization - clear database request",
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "postgres-pro,backend-developer,code-reviewer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Event sourcing aggregate design",
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Datadog APM tracing setup",
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "datadog-specialist,python-pro,backend-developer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Test automation framework setup",
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "test-automator,qa-expert,backend-developer,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API endpoint design",
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": "api-designer,backend-developer,documentation-engineer,code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Kubernetes deployment configuration",
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": "kubernetes-specialist,microservices-architect,backend-developer,development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Python Django application development",
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": "django-developer,backend-developer,api-designer,documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Security vulnerability assessment",
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": "qa-expert,code-reviewer,security-specialist,backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Performance optimization request",
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Documentation research request",
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": "research-analyst,backend-developer,documentation-engineer,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Ambiguous fix request",
        "vars": {
          "user_request": "fix this",
          "expected_agents": "debugger,code-reviewer,research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Vague improvement request",
        "vars": {
          "user_request": "make it better",
          "expected_agents": "backend-developer,code-reviewer,documentation-engineer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Generic help request",
        "vars": {
          "user_request": "help",
          "expected_agents": "research-analyst,backend-developer,documentation-engineer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Vague check request",
        "vars": {
          "user_request": "check this code",
          "expected_agents": "code-reviewer,debugger,python-pro",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Generic review request",
        "vars": {
          "user_request": "review my work",
          "expected_agents": "code-reviewer,documentation-engineer,research-analyst",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Ambiguous analyze request",
        "vars": {
          "user_request": "analyze this",
          "expected_agents": "research-analyst,context-manager",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Full stack implementation with testing",
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": "backend-developer,test-automator,documentation-engineer,api-designer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Database schema with event sourcing",
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": "postgres-pro,eventsourcing-expert,backend-developer,microservices-architect",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Kubernetes deployment with monitoring",
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": "kubernetes-specialist,datadog-specialist,backend-developer,development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API development with security testing",
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": "api-designer,test-automator,backend-developer,code-reviewer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "How does framework work",
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": "research-analyst,django-developer,backend-developer,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Best practices inquiry",
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?",
          "expected_agents": "research-analyst,postgres-pro,backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Documentation lookup",
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": "research-analyst,datadog-specialist,documentation-engineer,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Library research",
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": "research-analyst,datadog-specialist,python-pro,documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API reference lookup",
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": "research-analyst,datadog-specialist,documentation-engineer,backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for monitoring - observability",
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for monitoring - instrumentation",
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": "datadog-specialist,backend-developer,microservices-architect,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for testing - QA",
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": "test-automator,qa-expert,code-reviewer,development-orchestrator",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - query performance",
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": "postgres-pro,backend-developer,debugger,datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - distributed tracing",
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": "datadog-specialist,microservices-architect,backend-developer,debugger",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - container orchestration",
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Typo - postgres vs postgresql",
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": "postgres-pro,backend-developer,research-analyst,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Typo - k8s abbreviation",
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Common abbreviation - API",
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": "api-designer,backend-developer,documentation-engineer,microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Debug production issue with monitoring",
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": "debugger,datadog-specialist,backend-developer,aws-cloud-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Migration with testing",
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": "postgres-pro,test-automator,backend-developer,development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Cloud infrastructure setup",
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": "aws-cloud-specialist,datadog-specialist,development-orchestrator,documentation-engineer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Django-specific request",
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": "django-developer,backend-developer,python-pro,code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "FastAPI development",
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": "python-pro,backend-developer,api-designer,documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Error debugging",
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": "debugger,backend-developer,python-pro,code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Test failure debugging",
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": "debugger,test-automator,code-reviewer,qa-expert",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Performance bottleneck",
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": "backend-developer,datadog-specialist,debugger,microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Code review request",
        "vars": {
          "user_request": "review this pull request for quality",
          "expected_agents": "code-reviewer,backend-developer,documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Documentation writing",
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": "documentation-engineer,api-designer,backend-developer,research-analyst",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Metrics collection",
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": "datadog-specialist,backend-developer,aws-cloud-specialist,documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Log aggregation",
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": "datadog-specialist,aws-cloud-specialist,backend-developer,microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "OpenTelemetry setup",
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": "datadog-specialist,backend-developer,microservices-architect,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Projection implementation",
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": "eventsourcing-expert,backend-developer,python-pro,microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Domain events design",
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "CQRS pattern",
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": "backend-developer,microservices-architect,code-reviewer,documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Completely unrelated request",
        "vars": {
          "user_request": "what's the weather today?",
          "expected_agents": "research-analyst,aws-cloud-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      },
      {
        "description": "General conversation",
        "vars": {
          "user_request": "tell me a joke",
          "expected_agents": "claude-specialist,backend-developer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      },
      {
        "description": "Non-technical question",
        "vars": {
          "user_request": "what's the meaning of life?",
          "expected_agents": "research-analyst,trend-analyst,claude-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      }
    ],
    "scenarios": [],
    "env": {},
    "sharing": false,
    "defaultTest": {
      "assert": [
        {
          "type": "javascript",
          "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
        },
        {
          "type": "javascript",
          "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
        }
      ],
      "vars": {},
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "results/hook-validation.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {
      "maxConcurrency": 10,
      "cache": true,
      "showProgressBar": true
    }
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.119.9",
    "nodeVersion": "v25.1.0",
    "platform": "darwin",
    "arch": "x64",
    "exportedAt": "2025-11-21T12:15:59.059Z",
    "evaluationCreatedAt": "2025-11-21T12:15:57.454Z"
  }
}