{
  "evalId": "eval-fe5-2025-11-21T12:19:03",
  "results": {
    "version": 3,
    "timestamp": "2025-11-21T12:19:03.475Z",
    "prompts": [
      {
        "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
        "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
        "id": "70280830c14e7b4ff93d4d8a9e1c01ca6fbd31fd53aef9af6730ab3fdffd2412",
        "provider": "anthropic:claude-3-5-haiku-20241022",
        "metrics": {
          "score": 3.7222222222222223,
          "testPassCount": 2,
          "testFailCount": 2,
          "testErrorCount": 0,
          "assertPassCount": 14,
          "assertFailCount": 2,
          "totalLatencyMs": 5426,
          "tokenUsage": {
            "prompt": 7074,
            "completion": 71,
            "cached": 0,
            "total": 7145,
            "numRequests": 4,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.005943200000000001
        }
      }
    ],
    "results": [
      {
        "cost": 0.0014632,
        "error": "F1: 0.57, Precision: 0.67, Recall: 0.50 | Expected: [postgres-pro, backend-developer, code-reviewer, research-analyst] | Got: [postgres-pro, backend-developer, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8928571428571429,
          "reason": "F1: 0.57, Precision: 0.67, Recall: 0.50 | Expected: [postgres-pro, backend-developer, code-reviewer, research-analyst] | Got: [postgres-pro, backend-developer, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5714285714285715,
              "reason": "F1: 0.57, Precision: 0.67, Recall: 0.50 | Expected: [postgres-pro, backend-developer, code-reviewer, research-analyst] | Got: [postgres-pro, backend-developer, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "327bbee9-872f-4071-b7bc-8b7442fe71d1",
        "latencyMs": 1216,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "70280830c14e7b4ff93d4d8a9e1c01ca6fbd31fd53aef9af6730ab3fdffd2412",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,debugger",
          "tokenUsage": {
            "total": 1777,
            "prompt": 1764,
            "completion": 13
          },
          "finishReason": "stop",
          "cost": 0.0014632
        },
        "score": 0.8928571428571429,
        "success": false,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query",
            "expected_agents": "postgres-pro,backend-developer,code-reviewer,research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 0,
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "postgres-pro,backend-developer,code-reviewer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0015240000000000002,
        "gradingResult": {
          "pass": true,
          "score": 0.9722222222222222,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": true,
              "score": 0.888888888888889,
              "reason": "F1: 0.89, Precision: 0.80, Recall: 1.00 | Expected: [eventsourcing-expert, backend-developer, microservices-architect, python-pro] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "37c9c0ba-c4c5-43a1-9a6c-dee2e6218571",
        "latencyMs": 1486,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "70280830c14e7b4ff93d4d8a9e1c01ca6fbd31fd53aef9af6730ab3fdffd2412",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,research-analyst",
          "tokenUsage": {
            "total": 1797,
            "prompt": 1770,
            "completion": 27
          },
          "finishReason": "stop",
          "cost": 0.0015240000000000002
        },
        "score": 0.9722222222222222,
        "success": true,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system",
            "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 1,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.0014776000000000001,
        "gradingResult": {
          "pass": true,
          "score": 0.9642857142857143,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": true,
              "score": 0.8571428571428571,
              "reason": "F1: 0.86, Precision: 1.00, Recall: 0.75 | Expected: [datadog-specialist, python-pro, backend-developer, research-analyst] | Got: [datadog-specialist, python-pro, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b4e678d2-b6ad-44ab-919a-50c47617d192",
        "latencyMs": 1341,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "70280830c14e7b4ff93d4d8a9e1c01ca6fbd31fd53aef9af6730ab3fdffd2412",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer",
          "tokenUsage": {
            "total": 1787,
            "prompt": 1772,
            "completion": 15
          },
          "finishReason": "stop",
          "cost": 0.0014776000000000001
        },
        "score": 0.9642857142857143,
        "success": true,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app",
            "expected_agents": "datadog-specialist,python-pro,backend-developer,research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 2,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "datadog-specialist,python-pro,backend-developer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0.0014784000000000002,
        "error": "F1: 0.57, Precision: 0.67, Recall: 0.50 | Expected: [test-automator, qa-expert, backend-developer, code-reviewer] | Got: [test-automator, qa-expert, development-orchestrator]",
        "gradingResult": {
          "pass": false,
          "score": 0.8928571428571429,
          "reason": "F1: 0.57, Precision: 0.67, Recall: 0.50 | Expected: [test-automator, qa-expert, backend-developer, code-reviewer] | Got: [test-automator, qa-expert, development-orchestrator]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5714285714285715,
              "reason": "F1: 0.57, Precision: 0.67, Recall: 0.50 | Expected: [test-automator, qa-expert, backend-developer, code-reviewer] | Got: [test-automator, qa-expert, development-orchestrator]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "98b4027a-0ecb-417b-81fd-69fe6139e630",
        "latencyMs": 1383,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "70280830c14e7b4ff93d4d8a9e1c01ca6fbd31fd53aef9af6730ab3fdffd2412",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,development-orchestrator",
          "tokenUsage": {
            "total": 1784,
            "prompt": 1768,
            "completion": 16
          },
          "finishReason": "stop",
          "cost": 0.0014784000000000002
        },
        "score": 0.8928571428571429,
        "success": false,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application",
            "expected_agents": "test-automator,qa-expert,backend-developer,code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 3,
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "test-automator,qa-expert,backend-developer,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      }
    ],
    "stats": {
      "successes": 2,
      "failures": 2,
      "errors": 0,
      "tokenUsage": {
        "prompt": 7074,
        "completion": 71,
        "cached": 0,
        "total": 7145,
        "numRequests": 4,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      }
    }
  },
  "config": {
    "tags": {},
    "description": "Agent Discovery Hook - LLM Matching Evaluation",
    "prompts": [
      "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: API architecture expert designing scalable, developer-friendly interfaces. Use PROACTIVELY for designing REST or GraphQL APIs, creating OpenAPI specifications, defining API versioning strategies, or improving developer experience.\n- aws-cloud-specialist: PROACTIVE AWS specialist - auto-engages for AWS services, CloudFormation, Terraform, serverless, IaC, cloud architecture, IAM, cost optimization. Validates via WebFetch.\n- backend-developer: Senior backend engineer specializing in scalable API development and microservices architecture. Use PROACTIVELY for building scalable, secure, and performant backend systems with RESTful APIs, database optimization, and microservices patterns.\n- claude-specialist: Expert in Claude Code configuration, instruction files, and agent ecosystem optimization. MUST BE USED for questions about CLAUDE.md, .claude/instructions.md, instruction files, .claude directory structure, agent orchestration strategies, or Claude Code best practices. Use PROACTIVELY to analyze and improve project documentation patterns.\n- code-reviewer: PROACTIVE code review specialist - automatically engages after ANY code changes to validate quality, security, performance, and best practices. Use WITHOUT waiting for explicit user request.\n- context-manager: Expert context manager specializing in information storage, retrieval, and synchronization across multi-agent systems. Use PROACTIVELY for managing shared knowledge, optimizing context windows, maintaining state across agents, or improving information retrieval performance.\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch.\n- debugger: Expert debugger specializing in complex issue diagnosis, root cause analysis, and systematic problem-solving. Use proactively for investigating bugs, analyzing error traces, diagnosing production issues, and resolving intricate software problems.\n- development-orchestrator: PROACTIVE development orchestrator - automatically coordinates multiple specialized agents for complex development tasks. Triggers on implement feature, add functionality, fix bug, refactor, multi-step development tasks requiring 3+ agents, requests like implement test document and deploy, or when user explicitly requests orchestration. Use WITHOUT waiting for explicit request when development work spans multiple domains.\n- django-developer: Expert Django developer mastering Django 4+ with modern Python practices. Specializes in scalable web applications, REST API development, async views, and enterprise patterns. Use proactively for Django-specific development tasks.\n- documentation-engineer: PROACTIVE expert documentation engineer - automatically engages for API documentation, OpenAPI schema updates, technical writing, and documentation maintenance. Triggers on: API endpoint changes, OpenAPI schema, documentation updates, README files, technical guides, code examples, API reference, developer documentation, or any documentation-related tasks. Use WITHOUT waiting for explicit user request.\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned. Provides documentation-backed guidance for implementing event sourcing in DDD applications.\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub installation, webhooks, App authentication, integration setup, webhook events, installation tokens, webhook payloads.\n- kubernetes-specialist: PROACTIVE expert Kubernetes specialist - automatically engages for ALL container orchestration, deployment, and infrastructure topics. Triggers on: Kubernetes (deployments, pods, services, ingress, configmaps, secrets), Docker/containers, GitOps (Flux, ArgoCD), Kustomize, Helm, deployment manifests, CI/CD pipelines, infrastructure-as-code, cluster configuration, or any deployment/infrastructure discussion. Use WITHOUT waiting for explicit user request.\n- microservices-architect: Distributed systems architect specializing in scalable microservice ecosystems. Use PROACTIVELY for designing service boundaries, defining inter-service communication, implementing resilience patterns, or architecting cloud-native distributed systems.\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability. Use PROACTIVELY for PostgreSQL-specific tasks including query tuning, replication, backup/recovery, and advanced PostgreSQL features.\n- promptfoo-specialist: PROACTIVE promptfoo specialist - auto-engages for prompt evaluation, LLM testing, AI quality assurance, model testing, prompt engineering validation, and promptfoo configuration. Triggers on \"promptfoo\", \"prompt evaluation\", \"prompt testing\", \"LLM testing\", \"AI testing\", \"ML testing\", \"model testing\", \"evaluate prompts\", \"test AI\", or any prompt/model quality assurance request. Use WITHOUT waiting for explicit request when prompt testing or LLM evaluation needed.\n- python-pro: Expert Python developer specializing in modern Python 3.11+ development with deep expertise in type safety, async programming, data science, and web frameworks. Use PROACTIVELY for Python-specific optimization, type hints, and Pythonic patterns.\n- qa-expert: PROACTIVE QA specialist - automatically engages when user mentions quality assurance, test planning, test strategy, test execution, quality metrics, defect management, test methodologies, or quality standards. Triggers on requests to plan tests, review quality, analyze defects, assess test coverage, validate requirements, or improve quality processes. Use WITHOUT waiting for explicit user request.\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering. Triggers on \"how does X work\", \"look up docs for Y\", \"research Z library\", \"find documentation about...\", \"what are best practices for...\", \"fetch docs\", API references, framework guides, or any documentation/research request. Use WITHOUT waiting for explicit request when documentation validation needed.\n- task-distributor: Expert task distributor specializing in intelligent work allocation, load balancing, and queue management. Use PROACTIVELY for optimizing task distribution, implementing priority scheduling, managing work queues, or balancing workload across systems.\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage, CI/CD testing, unit tests, integration tests, e2e tests, or test execution. Triggers on requests to write tests, run tests, fix failing tests, improve test coverage, set up testing infrastructure, or optimize test performance. Use WITHOUT waiting for explicit user request.\n- toolkit-manager: PROACTIVE toolkit manager for Claude Code ecosystem management. Use PROACTIVELY when users request to create/add/make/build/implement/modify/update/analyze/review/improve/standardize any agent, skill, or hook. Triggers include \"create [name] agent\", \"add agent for [topic]\", \"make an agent that...\", \"build agent to...\", \"implement agent for...\", \"update agent\", \"analyze agents\", \"review agent\", \"check for redundancy\", \"standardize configuration\", \"improve toolkit\", or any agent/skill/hook lifecycle operations.\n- trend-analyst: Specialist in identifying emerging patterns, forecasting developments, and strategic foresight. Use proactively for trend identification, technology forecasting, market evolution analysis, or anticipating industry shifts.\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
    ],
    "providers": [
      {
        "id": "anthropic:claude-3-5-haiku-20241022",
        "config": {
          "temperature": 0,
          "max_tokens": 100
        }
      }
    ],
    "tests": [
      {
        "description": "PostgreSQL query optimization - clear database request",
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "postgres-pro,backend-developer,code-reviewer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Event sourcing aggregate design",
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Datadog APM tracing setup",
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "datadog-specialist,python-pro,backend-developer,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Test automation framework setup",
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "test-automator,qa-expert,backend-developer,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API endpoint design",
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": "api-designer,backend-developer,documentation-engineer,code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Kubernetes deployment configuration",
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": "kubernetes-specialist,microservices-architect,backend-developer,development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Python Django application development",
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": "django-developer,backend-developer,api-designer,documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Security vulnerability assessment",
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": "qa-expert,code-reviewer,security-specialist,backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Performance optimization request",
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Documentation research request",
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": "research-analyst,backend-developer,documentation-engineer,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Ambiguous fix request",
        "vars": {
          "user_request": "fix this",
          "expected_agents": "debugger,code-reviewer,research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Vague improvement request",
        "vars": {
          "user_request": "make it better",
          "expected_agents": "backend-developer,code-reviewer,documentation-engineer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Generic help request",
        "vars": {
          "user_request": "help",
          "expected_agents": "research-analyst,backend-developer,documentation-engineer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Vague check request",
        "vars": {
          "user_request": "check this code",
          "expected_agents": "code-reviewer,debugger,python-pro",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Generic review request",
        "vars": {
          "user_request": "review my work",
          "expected_agents": "code-reviewer,documentation-engineer,research-analyst",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Ambiguous analyze request",
        "vars": {
          "user_request": "analyze this",
          "expected_agents": "research-analyst,context-manager",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Full stack implementation with testing",
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": "backend-developer,test-automator,documentation-engineer,api-designer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Database schema with event sourcing",
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": "postgres-pro,eventsourcing-expert,backend-developer,microservices-architect",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Kubernetes deployment with monitoring",
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": "kubernetes-specialist,datadog-specialist,backend-developer,development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API development with security testing",
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": "api-designer,test-automator,backend-developer,code-reviewer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "How does framework work",
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": "research-analyst,django-developer,backend-developer,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Best practices inquiry",
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?",
          "expected_agents": "research-analyst,postgres-pro,backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Documentation lookup",
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": "research-analyst,datadog-specialist,documentation-engineer,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Library research",
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": "research-analyst,datadog-specialist,python-pro,documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API reference lookup",
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": "research-analyst,datadog-specialist,documentation-engineer,backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for monitoring - observability",
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for monitoring - instrumentation",
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": "datadog-specialist,backend-developer,microservices-architect,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for testing - QA",
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": "test-automator,qa-expert,code-reviewer,development-orchestrator",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - query performance",
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": "postgres-pro,backend-developer,debugger,datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - distributed tracing",
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": "datadog-specialist,microservices-architect,backend-developer,debugger",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - container orchestration",
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Typo - postgres vs postgresql",
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": "postgres-pro,backend-developer,research-analyst,code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Typo - k8s abbreviation",
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Common abbreviation - API",
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": "api-designer,backend-developer,documentation-engineer,microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Debug production issue with monitoring",
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": "debugger,datadog-specialist,backend-developer,aws-cloud-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Migration with testing",
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": "postgres-pro,test-automator,backend-developer,development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Cloud infrastructure setup",
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": "aws-cloud-specialist,datadog-specialist,development-orchestrator,documentation-engineer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Django-specific request",
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": "django-developer,backend-developer,python-pro,code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "FastAPI development",
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": "python-pro,backend-developer,api-designer,documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Error debugging",
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": "debugger,backend-developer,python-pro,code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Test failure debugging",
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": "debugger,test-automator,code-reviewer,qa-expert",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Performance bottleneck",
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": "backend-developer,datadog-specialist,debugger,microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Code review request",
        "vars": {
          "user_request": "review this pull request for quality",
          "expected_agents": "code-reviewer,backend-developer,documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Documentation writing",
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": "documentation-engineer,api-designer,backend-developer,research-analyst",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Metrics collection",
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": "datadog-specialist,backend-developer,aws-cloud-specialist,documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Log aggregation",
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": "datadog-specialist,aws-cloud-specialist,backend-developer,microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "OpenTelemetry setup",
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": "datadog-specialist,backend-developer,microservices-architect,research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Projection implementation",
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": "eventsourcing-expert,backend-developer,python-pro,microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Domain events design",
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": "eventsourcing-expert,backend-developer,microservices-architect,python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "CQRS pattern",
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": "backend-developer,microservices-architect,code-reviewer,documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Completely unrelated request",
        "vars": {
          "user_request": "what's the weather today?",
          "expected_agents": "research-analyst,aws-cloud-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      },
      {
        "description": "General conversation",
        "vars": {
          "user_request": "tell me a joke",
          "expected_agents": "claude-specialist,backend-developer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      },
      {
        "description": "Non-technical question",
        "vars": {
          "user_request": "what's the meaning of life?",
          "expected_agents": "research-analyst,trend-analyst,claude-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      }
    ],
    "scenarios": [],
    "env": {},
    "sharing": false,
    "defaultTest": {
      "assert": [
        {
          "type": "javascript",
          "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
        },
        {
          "type": "javascript",
          "value": "// Get expected agents from test metadata (comma-separated string)\nlet expectedStr = context.vars.expected_agents || '';\n// Convert comma-separated string to array\nlet expected = expectedStr ? expectedStr.split(',').map(a => a.trim()) : [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
        }
      ],
      "vars": {},
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "results/sync-validation.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {
      "maxConcurrency": 10,
      "cache": true,
      "showProgressBar": true
    }
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.119.9",
    "nodeVersion": "v25.1.0",
    "platform": "darwin",
    "arch": "x64",
    "exportedAt": "2025-11-21T12:19:05.046Z",
    "evaluationCreatedAt": "2025-11-21T12:19:03.475Z"
  }
}