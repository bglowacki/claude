{
  "evalId": "eval-LcV-2025-11-21T11:08:14",
  "results": {
    "version": 3,
    "timestamp": "2025-11-21T11:08:14.379Z",
    "prompts": [
      {
        "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
        "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
        "id": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "provider": "anthropic:claude-3-5-haiku-20241022",
        "metrics": {
          "score": 12.5,
          "testPassCount": 0,
          "testFailCount": 53,
          "testErrorCount": 0,
          "assertPassCount": 50,
          "assertFailCount": 162,
          "totalLatencyMs": 1993,
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 48374,
            "total": 48374,
            "numRequests": 53,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.05459039999999999
        }
      }
    ],
    "results": [
      {
        "cost": 0.0010536,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- postgres-pro: Direct expert for PostgreSQL query optimization\n- backend-developer: Relevant for database query and system performance\n- code-reviewer: Can analyze query structure and potential improvements\n- research-analyst: Can help research best practices for PostgreSQL query optimization\n\nThe request is clear and specifically seeks optimization of a PostgreSQL query, making these agents the most relevant for providing targete"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "69f79082-75a3-41f0-945e-73904842ba18",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,code-reviewer,research-analyst\n\nRationale:\n- postgres-pro: Direct expert for PostgreSQL query optimization\n- backend-developer: Relevant for database query and system performance\n- code-reviewer: Can analyze query structure and potential improvements\n- research-analyst: Can help research best practices for PostgreSQL query optimization\n\nThe request is clear and specifically seeks optimization of a PostgreSQL query, making these agents the most relevant for providing targete",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "length",
          "cost": 0.0010536
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "postgres-pro"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 0,
        "vars": {
          "user_request": "optimize this PostgreSQL query"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010584000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- eventsourcing-expert: Direct match for event sourcing aggregate design\n- backend-developer: Crucial for system architecture and implementation\n- microservices-architect: Helps with distributed system design considerations\n- python-pro: Technical expertise in Python implementation\n- documentation-engineer: Ensures clear documentation of the aggregate design"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "9b140772-6020-4788-a1bd-51901508ba8c",
        "latencyMs": 43,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,documentation-engineer\n\nRationale:\n- eventsourcing-expert: Direct match for event sourcing aggregate design\n- backend-developer: Crucial for system architecture and implementation\n- microservices-architect: Helps with distributed system design considerations\n- python-pro: Technical expertise in Python implementation\n- documentation-engineer: Ensures clear documentation of the aggregate design",
          "tokenUsage": {
            "cached": 923,
            "total": 923
          },
          "finishReason": "length",
          "cost": 0.0010584000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "eventsourcing-expert"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 1,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001052,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- datadog-specialist: Direct match for Datadog APM tracing setup\n- python-pro: Python-specific implementation expertise\n- backend-developer: Server-side tracing and instrumentation context\n- research-analyst: Can help find best practices and documentation\n- code-reviewer: Ensure proper implementation and best practices"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "8adf32bf-003b-4206-9704-179f9fbc581a",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer,research-analyst,code-reviewer\n\nRationale:\n- datadog-specialist: Direct match for Datadog APM tracing setup\n- python-pro: Python-specific implementation expertise\n- backend-developer: Server-side tracing and instrumentation context\n- research-analyst: Can help find best practices and documentation\n- code-reviewer: Ensure proper implementation and best practices",
          "tokenUsage": {
            "cached": 923,
            "total": 923
          },
          "finishReason": "stop",
          "cost": 0.001052
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 2,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010408000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- test-automator: Directly matches the core request for automated testing\n- qa-expert: Provides comprehensive testing strategy expertise\n- backend-developer: Can help design testable application architecture\n- code-reviewer: Ensures testing implementation follows best practices\n- documentation-engineer: Can help document the testing approach and processes"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7056c0fc-b60e-4d79-9076-58423fc20ec4",
        "latencyMs": 51,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,backend-developer,code-reviewer,documentation-engineer\n\nRationale:\n- test-automator: Directly matches the core request for automated testing\n- qa-expert: Provides comprehensive testing strategy expertise\n- backend-developer: Can help design testable application architecture\n- code-reviewer: Ensures testing implementation follows best practices\n- documentation-engineer: Can help document the testing approach and processes",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "stop",
          "cost": 0.0010408000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "test-automator"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 3,
        "vars": {
          "user_request": "help me set up automated testing for my application"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010568,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: microservices-architect\n\nRationale:\n- api-designer: Direct match for RESTful API endpoint design\n- backend-developer: Complements API design with server-side implementation perspective\n- documentation-engineer: Critical for creating comprehensive API documentation\n- code-reviewer: Ensures API design follows best practices and quality standards\n- microservices-architect: Provides architectural insights for scal"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c41135b1-7b5c-4ef9-9e31-a0d896d8e61c",
        "latencyMs": 55,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design RESTful API endpoints for user management\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,code-reviewer,microservices-architect\n\nRationale:\n- api-designer: Direct match for RESTful API endpoint design\n- backend-developer: Complements API design with server-side implementation perspective\n- documentation-engineer: Critical for creating comprehensive API documentation\n- code-reviewer: Ensures API design follows best practices and quality standards\n- microservices-architect: Provides architectural insights for scal",
          "tokenUsage": {
            "cached": 921,
            "total": 921
          },
          "finishReason": "length",
          "cost": 0.0010568
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "API endpoint design",
          "vars": {
            "user_request": "design RESTful API endpoints for user management"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "api-designer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 4,
        "vars": {
          "user_request": "design RESTful API endpoints for user management"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010568,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- kubernetes-specialist: Direct match for creating Kubernetes manifests\n- microservices-architect: Relevant for microservice-specific architecture considerations\n- backend-developer: Provides server-side perspective on microservice implementation\n- documentation-engineer: Helps document the Kubernetes manifests\n- code-reviewer: Ensures quality and best practices in"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f5940289-93d7-4282-a613-d771e6694b0a",
        "latencyMs": 69,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Kubernetes manifests for my microservice\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,microservices-architect,backend-developer,documentation-engineer,code-reviewer\n\nRationale:\n- kubernetes-specialist: Direct match for creating Kubernetes manifests\n- microservices-architect: Relevant for microservice-specific architecture considerations\n- backend-developer: Provides server-side perspective on microservice implementation\n- documentation-engineer: Helps document the Kubernetes manifests\n- code-reviewer: Ensures quality and best practices in",
          "tokenUsage": {
            "cached": 921,
            "total": 921
          },
          "finishReason": "length",
          "cost": 0.0010568
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment configuration",
          "vars": {
            "user_request": "create Kubernetes manifests for my microservice"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "kubernetes-specialist"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 5,
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010472,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- django-developer: Specific expertise in Django REST Framework\n- backend-developer: Server-side logic and API design skills\n- api-designer: RESTful API design best practices\n- documentation-engineer: Technical documentation for the API\n- code-reviewer: Ensure code quality and best practices for the Django REST API with authentication"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e755f305-28a6-4b79-a3d7-bcc1be680160",
        "latencyMs": 60,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build a Django REST API with authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,api-designer,documentation-engineer,code-reviewer\n\nRationale:\n- django-developer: Specific expertise in Django REST Framework\n- backend-developer: Server-side logic and API design skills\n- api-designer: RESTful API design best practices\n- documentation-engineer: Technical documentation for the API\n- code-reviewer: Ensure code quality and best practices for the Django REST API with authentication",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "stop",
          "cost": 0.0010472
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Python Django application development",
          "vars": {
            "user_request": "build a Django REST API with authentication"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "django-developer",
            "python-pro"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 6,
        "vars": {
          "user_request": "build a Django REST API with authentication"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: security-specialist, qa-expert\n\nRationale:\n- code-reviewer: Directly relevant for security vulnerability audit\n- security-specialist: Would provide targeted security analysis (though not in original list, this would be ideal)\n- backend-developer: Can help identify potential backend security weaknesses\n- aws-cloud-specialist: Can assess cloud-specific security configurations\n- qa-expert: Brings comprehensive"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f5659768-4fb2-4ef3-abb3-c68618e00017",
        "latencyMs": 75,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: audit my application for security vulnerabilities\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,security-specialist,backend-developer,aws-cloud-specialist,qa-expert\n\nRationale:\n- code-reviewer: Directly relevant for security vulnerability audit\n- security-specialist: Would provide targeted security analysis (though not in original list, this would be ideal)\n- backend-developer: Can help identify potential backend security weaknesses\n- aws-cloud-specialist: Can assess cloud-specific security configurations\n- qa-expert: Brings comprehensive",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Security vulnerability assessment",
          "vars": {
            "user_request": "audit my application for security vulnerabilities"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "qa-expert"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 7,
        "vars": {
          "user_request": "audit my application for security vulnerabilities"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010568,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: debugger\n\nRationale:\n- backend-developer: Core expertise in API performance and server-side optimization\n- aws-cloud-specialist: Can help with cloud-based performance scaling and infrastructure\n- datadog-specialist: Provides observability and performance monitoring insights\n- microservices-architect: Can analyze system design for performance bottlenecks\n- debugger:"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "30f7ad50-d7ae-466c-a424-5259d8c831cf",
        "latencyMs": 64,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my API is slow, help me optimize performance\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect,debugger\n\nRationale:\n- backend-developer: Core expertise in API performance and server-side optimization\n- aws-cloud-specialist: Can help with cloud-based performance scaling and infrastructure\n- datadog-specialist: Provides observability and performance monitoring insights\n- microservices-architect: Can analyze system design for performance bottlenecks\n- debugger:",
          "tokenUsage": {
            "cached": 921,
            "total": 921
          },
          "finishReason": "length",
          "cost": 0.0010568
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Performance optimization request",
          "vars": {
            "user_request": "my API is slow, help me optimize performance"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "backend-developer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 8,
        "vars": {
          "user_request": "my API is slow, help me optimize performance"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001032,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: api-designer\n\nRationale:\n- research-analyst: Best for documentation lookup and framework research\n- backend-developer: Relevant for server-side async patterns\n- documentation-engineer: Helpful for technical documentation specifics\n- python-pro: Strong Python ecosystem knowledge for FastAPI\n- api-designer: Expertise in API design and best practices"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "24032f41-0968-4423-aecd-59fa43980440",
        "latencyMs": 80,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: look up documentation for FastAPI async patterns\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer,python-pro,api-designer\n\nRationale:\n- research-analyst: Best for documentation lookup and framework research\n- backend-developer: Relevant for server-side async patterns\n- documentation-engineer: Helpful for technical documentation specifics\n- python-pro: Strong Python ecosystem knowledge for FastAPI\n- api-designer: Expertise in API design and best practices",
          "tokenUsage": {
            "cached": 914,
            "total": 914
          },
          "finishReason": "stop",
          "cost": 0.001032
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Documentation research request",
          "vars": {
            "user_request": "look up documentation for FastAPI async patterns"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "research-analyst"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 9,
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009712000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: NONE\n\nRationale:\nThe request \"fix this\" is extremely vague and lacks context. Without additional information about:\n- What specifically needs fixing\n- What system/code/process is involved\n- What the current problem or error is\n\nThere's insufficient detail to confidently recommend any specific agents. More context would be needed to make a meaningful agent selection."
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "9579cf6d-55ce-4bc0-a147-10d5c80fcd74",
        "latencyMs": 54,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fix this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "NONE\n\nRationale:\nThe request \"fix this\" is extremely vague and lacks context. Without additional information about:\n- What specifically needs fixing\n- What system/code/process is involved\n- What the current problem or error is\n\nThere's insufficient detail to confidently recommend any specific agents. More context would be needed to make a meaningful agent selection.",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0009712000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Ambiguous fix request",
          "vars": {
            "user_request": "fix this"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 10,
        "vars": {
          "user_request": "fix this"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001052,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: Let me analyze the request \"make it better\":\n\nThe request is extremely vague and lacks context. Without specific details about what needs improvement (code, process, system, document, etc.), it's challenging to definitively select agents.\n\nHowever, given the generic nature of \"make it better\", I'll suggest a few versatile agents that could help improve something:\n\ncode-reviewer, documentation-engineer\n\nRationale:\n- code-reviewer can analyze an"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "515ee057-fe73-43fa-a993-c13b5bea9fea",
        "latencyMs": 76,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: make it better\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "Let me analyze the request \"make it better\":\n\nThe request is extremely vague and lacks context. Without specific details about what needs improvement (code, process, system, document, etc.), it's challenging to definitively select agents.\n\nHowever, given the generic nature of \"make it better\", I'll suggest a few versatile agents that could help improve something:\n\ncode-reviewer,backend-developer,documentation-engineer\n\nRationale:\n- code-reviewer can analyze an",
          "tokenUsage": {
            "cached": 915,
            "total": 915
          },
          "finishReason": "length",
          "cost": 0.001052
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Vague improvement request",
          "vars": {
            "user_request": "make it better"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 11,
        "vars": {
          "user_request": "make it better"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009344,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- The request is extremely vague (\"help\") with no specific context\n- \"help\" could mean many things\n- research-analyst is best suited to clarify requirements and gather more information before engaging other specialized agents\n- This agent can probe for more details and potentially recommend more targeted assistance"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "909f2583-32b5-4c02-a6ae-2d80b1a3e9a8",
        "latencyMs": 74,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst\n\nRationale:\n- The request is extremely vague (\"help\") with no specific context\n- \"help\" could mean many things\n- research-analyst is best suited to clarify requirements and gather more information before engaging other specialized agents\n- This agent can probe for more details and potentially recommend more targeted assistance",
          "tokenUsage": {
            "cached": 884,
            "total": 884
          },
          "finishReason": "stop",
          "cost": 0.0009344
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Generic help request",
          "vars": {
            "user_request": "help"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 12,
        "vars": {
          "user_request": "help"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.000972,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: python-pro\n\nReasoning:\n- \"check this code\" suggests a code review and potential debugging\n- The request seems to be about reviewing code quality and potential issues\n- Python-pro is included as a general development expertise agent\n- These agents are most likely to provide systematic code analysis, troubleshooting, and development best practices"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "543579e7-3546-4820-8c6e-50ef06eec38d",
        "latencyMs": 37,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: check this code\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,debugger,python-pro\n\nReasoning:\n- \"check this code\" suggests a code review and potential debugging\n- The request seems to be about reviewing code quality and potential issues\n- Python-pro is included as a general development expertise agent\n- These agents are most likely to provide systematic code analysis, troubleshooting, and development best practices",
          "tokenUsage": {
            "cached": 895,
            "total": 895
          },
          "finishReason": "stop",
          "cost": 0.000972
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Vague check request",
          "vars": {
            "user_request": "check this code"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "code-reviewer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 13,
        "vars": {
          "user_request": "check this code"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009400000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nReasoning:\n- \"review my work\" suggests a need for code/work review\n- code-reviewer is the most direct match for systematic review\n- documentation-engineer can help formalize review findings\n- research-analyst can help gather context and best practices for the review"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "014c7212-2d41-47d4-9b33-ff71b289ca64",
        "latencyMs": 42,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review my work\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,documentation-engineer,research-analyst\n\nReasoning:\n- \"review my work\" suggests a need for code/work review\n- code-reviewer is the most direct match for systematic review\n- documentation-engineer can help formalize review findings\n- research-analyst can help gather context and best practices for the review",
          "tokenUsage": {
            "cached": 887,
            "total": 887
          },
          "finishReason": "stop",
          "cost": 0.0009400000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Generic review request",
          "vars": {
            "user_request": "review my work"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "code-reviewer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 14,
        "vars": {
          "user_request": "review my work"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009192000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- The request \"analyze this\" is extremely vague and lacks specific context\n- \"research-analyst\" is the most appropriate agent to help clarify the request and gather more information\n- This agent can help probe for additional details and understand the intent behind the analysis request"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e119c4eb-198d-449f-b3a1-555305116d4d",
        "latencyMs": 41,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: analyze this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst\n\nRationale:\n- The request \"analyze this\" is extremely vague and lacks specific context\n- \"research-analyst\" is the most appropriate agent to help clarify the request and gather more information\n- This agent can help probe for additional details and understand the intent behind the analysis request",
          "tokenUsage": {
            "cached": 881,
            "total": 881
          },
          "finishReason": "stop",
          "cost": 0.0009192000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Ambiguous analyze request",
          "vars": {
            "user_request": "analyze this"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 15,
        "vars": {
          "user_request": "analyze this"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "PROACTIVE agent research-analyst should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "PROACTIVE agent research-analyst should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: qa-expert\n\nRationale:\n- api-designer: Critical for designing the user registration API with best practices\n- backend-developer: Essential for implementing server-side registration logic\n- documentation-engineer: Needed to create comprehensive API documentation\n- test-automator: Important for creating automated tests for the registration API\n- qa-expert: Ensures overall quality and testing strategy for the API"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent research-analyst should trigger but was not suggested"
            }
          ]
        },
        "id": "21044b4e-73ff-4ee5-b67b-60a3a2b64fb4",
        "latencyMs": 40,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement user registration API with tests and documentation\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,test-automator,qa-expert\n\nRationale:\n- api-designer: Critical for designing the user registration API with best practices\n- backend-developer: Essential for implementing server-side registration logic\n- documentation-engineer: Needed to create comprehensive API documentation\n- test-automator: Important for creating automated tests for the registration API\n- qa-expert: Ensures overall quality and testing strategy for the API",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Full stack implementation with testing",
          "vars": {
            "user_request": "implement user registration API with tests and documentation"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "backend-developer",
            "test-automator",
            "documentation-engineer"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 16,
        "vars": {
          "user_request": "implement user registration API with tests and documentation"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010576000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- postgres-pro: Direct expertise in PostgreSQL schema design\n- backend-developer: Server-side architecture and database integration skills\n- eventsourcing-expert: Specific knowledge of event sourcing patterns and aggregates\n- microservices-architect: Distributed system design perspective\n- research-analyst: Can help gather best practices"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "47009efc-8305-4085-9dea-8ec87db88a10",
        "latencyMs": 41,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design PostgreSQL schema for event sourced aggregates\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,eventsourcing-expert,microservices-architect,research-analyst\n\nRationale:\n- postgres-pro: Direct expertise in PostgreSQL schema design\n- backend-developer: Server-side architecture and database integration skills\n- eventsourcing-expert: Specific knowledge of event sourcing patterns and aggregates\n- microservices-architect: Distributed system design perspective\n- research-analyst: Can help gather best practices",
          "tokenUsage": {
            "cached": 922,
            "total": 922
          },
          "finishReason": "length",
          "cost": 0.0010576000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Database schema with event sourcing",
          "vars": {
            "user_request": "design PostgreSQL schema for event sourced aggregates"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "postgres-pro",
            "eventsourcing-expert"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 17,
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010408000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: development-orchestrator\n\nRationale:\n- kubernetes-specialist: Direct match for Kubernetes deployment\n- datadog-specialist: Directly addresses monitoring requirement\n- backend-developer: Supports overall system architecture design\n- microservices-architect: Helps with distributed system considerations\n- development-orchestrator: Assists in coordinating complex deployment workflow"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e68aadc4-c10b-4d7c-948b-e42b6d574d36",
        "latencyMs": 43,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to Kubernetes with Datadog monitoring\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,datadog-specialist,backend-developer,microservices-architect,development-orchestrator\n\nRationale:\n- kubernetes-specialist: Direct match for Kubernetes deployment\n- datadog-specialist: Directly addresses monitoring requirement\n- backend-developer: Supports overall system architecture design\n- microservices-architect: Helps with distributed system considerations\n- development-orchestrator: Assists in coordinating complex deployment workflow",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "stop",
          "cost": 0.0010408000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment with monitoring",
          "vars": {
            "user_request": "deploy to Kubernetes with Datadog monitoring"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "kubernetes-specialist",
            "datadog-specialist"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 18,
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- api-designer: Essential for designing RESTful API architecture\n- backend-developer: Crucial for implementing server-side logic and API\n- code-reviewer: Critical for security audit and code quality checks\n- test-automator: Necessary for comprehensive API testing\n- documentation-engineer: Important for creating API documentation and specifications\n\nThe selected agents cover"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "76a2d169-3565-4f12-8be5-241a83d05198",
        "latencyMs": 46,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API with security audit and tests\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,code-reviewer,test-automator,documentation-engineer\n\nRationale:\n- api-designer: Essential for designing RESTful API architecture\n- backend-developer: Crucial for implementing server-side logic and API\n- code-reviewer: Critical for security audit and code quality checks\n- test-automator: Necessary for comprehensive API testing\n- documentation-engineer: Important for creating API documentation and specifications\n\nThe selected agents cover",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "API development with security testing",
          "vars": {
            "user_request": "build REST API with security audit and tests"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "api-designer",
            "qa-expert",
            "test-automator"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 19,
        "vars": {
          "user_request": "build REST API with security audit and tests"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010376,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- django-developer: Direct expertise in Django ORM\n- backend-developer: Relevant for database transaction understanding\n- python-pro: General Python database interaction knowledge\n- research-analyst: Can help gather comprehensive information about Django transaction handling\n- code-reviewer: Can provide insights into best practices and implementation details of database transactions"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "dd3b05dc-f80c-42c2-8548-97c7c9df2de2",
        "latencyMs": 45,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: how does Django's ORM handle database transactions?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,research-analyst,code-reviewer\n\nRationale:\n- django-developer: Direct expertise in Django ORM\n- backend-developer: Relevant for database transaction understanding\n- python-pro: General Python database interaction knowledge\n- research-analyst: Can help gather comprehensive information about Django transaction handling\n- code-reviewer: Can provide insights into best practices and implementation details of database transactions",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "stop",
          "cost": 0.0010376
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "How does framework work",
          "vars": {
            "user_request": "how does Django's ORM handle database transactions?"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "research-analyst"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 20,
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010464,
        "error": "PROACTIVE agent research-analyst should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "PROACTIVE agent research-analyst should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- postgres-pro: Direct expert in PostgreSQL, perfect for connection pooling best practices\n- backend-developer: Relevant for database integration and system architecture aspects of connection pooling\n- research-analyst: Can help gather comprehensive best practices and research on the topic\n\nThe request is specifically about PostgreSQL connection pooling best practices, which requires deep database and backend system knowledge."
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent research-analyst should trigger but was not suggested"
            }
          ]
        },
        "id": "9a62e633-753f-459f-b8e8-481d828d49d5",
        "latencyMs": 41,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what are best practices for PostgreSQL connection pooling?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst\n\nRationale:\n- postgres-pro: Direct expert in PostgreSQL, perfect for connection pooling best practices\n- backend-developer: Relevant for database integration and system architecture aspects of connection pooling\n- research-analyst: Can help gather comprehensive best practices and research on the topic\n\nThe request is specifically about PostgreSQL connection pooling best practices, which requires deep database and backend system knowledge.",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "stop",
          "cost": 0.0010464
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Best practices inquiry",
          "vars": {
            "user_request": "what are best practices for PostgreSQL connection pooling?"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "research-analyst"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 21,
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010576000000000001,
        "error": "PROACTIVE agent datadog-specialist should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "PROACTIVE agent datadog-specialist should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: datadog-specialist\n\nRationale:\n- research-analyst: Best for comprehensive documentation lookup and research\n- python-pro: Specific expertise in Python SDK documentation\n- documentation-engineer: Technical documentation specialist\n- datadog-specialist: Has specific OpenTelemetry expertise and observability background\n\nThe request is clearly about finding documentation for the OpenTelemetry Python SDK, which requires research, Python-specific"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent datadog-specialist should trigger but was not suggested"
            }
          ]
        },
        "id": "26c74cf5-5d16-4c60-824e-2d4236ef607d",
        "latencyMs": 42,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fetch documentation for OpenTelemetry Python SDK\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,python-pro,documentation-engineer,datadog-specialist\n\nRationale:\n- research-analyst: Best for comprehensive documentation lookup and research\n- python-pro: Specific expertise in Python SDK documentation\n- documentation-engineer: Technical documentation specialist\n- datadog-specialist: Has specific OpenTelemetry expertise and observability background\n\nThe request is clearly about finding documentation for the OpenTelemetry Python SDK, which requires research, Python-specific",
          "tokenUsage": {
            "cached": 922,
            "total": 922
          },
          "finishReason": "length",
          "cost": 0.0010576000000000001
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Documentation lookup",
          "vars": {
            "user_request": "fetch documentation for OpenTelemetry Python SDK"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "research-analyst"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 22,
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010504,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: backend-developer\n\nRationale:\n- datadog-specialist: Direct expertise with ddtrace library and distributed tracing\n- research-analyst: Can comprehensively research library features\n- python-pro: Python library context and implementation details\n- documentation-engineer: Can help analyze and document library features\n- backend-developer: Understands library integration and system architecture implications"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "cfaca411-874b-441f-99fc-90cfb2885040",
        "latencyMs": 49,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: research ddtrace library features\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,python-pro,documentation-engineer,backend-developer\n\nRationale:\n- datadog-specialist: Direct expertise with ddtrace library and distributed tracing\n- research-analyst: Can comprehensively research library features\n- python-pro: Python library context and implementation details\n- documentation-engineer: Can help analyze and document library features\n- backend-developer: Understands library integration and system architecture implications",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "stop",
          "cost": 0.0010504
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Library research",
          "vars": {
            "user_request": "research ddtrace library features"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "research-analyst"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 23,
        "vars": {
          "user_request": "research ddtrace library features"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010168,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- datadog-specialist: Direct expertise in Datadog metrics and observability\n- research-analyst: Can help find API reference documentation\n- documentation-engineer: Can help interpret and explain API reference details\n\nThe request is specifically about finding Datadog metrics submission API reference, which makes these agents the most relevant for addressing the task."
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a6cee94f-4ada-4423-974c-e7dc2dea2fa8",
        "latencyMs": 54,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: find API reference for Datadog metrics submission\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer\n\nRationale:\n- datadog-specialist: Direct expertise in Datadog metrics and observability\n- research-analyst: Can help find API reference documentation\n- documentation-engineer: Can help interpret and explain API reference details\n\nThe request is specifically about finding Datadog metrics submission API reference, which makes these agents the most relevant for addressing the task.",
          "tokenUsage": {
            "cached": 911,
            "total": 911
          },
          "finishReason": "stop",
          "cost": 0.0010168
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "API reference lookup",
          "vars": {
            "user_request": "find API reference for Datadog metrics submission"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "research-analyst"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 24,
        "vars": {
          "user_request": "find API reference for Datadog metrics submission"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- datadog-specialist: Direct match for observability implementation\n- microservices-architect: Expertise in distributed system observability design\n- backend-developer: Technical implementation of observability strategies\n- aws-cloud-specialist: Cloud monitoring and observability services\n- documentation-engineer: Helps document observability setup and practices"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "03b0850d-f6b4-48e2-88c1-b62544785b05",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement observability for my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist,documentation-engineer\n\nRationale:\n- datadog-specialist: Direct match for observability implementation\n- microservices-architect: Expertise in distributed system observability design\n- backend-developer: Technical implementation of observability strategies\n- aws-cloud-specialist: Cloud monitoring and observability services\n- documentation-engineer: Helps document observability setup and practices",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - observability",
          "vars": {
            "user_request": "implement observability for my microservices"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 25,
        "vars": {
          "user_request": "implement observability for my microservices"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- datadog-specialist: Direct expertise in request latency tracking, observability, and APM\n- backend-developer: Technical implementation of instrumentation\n- microservices-architect: Architectural perspective on distributed tracing\n- code-reviewer: Ensures quality and best practices of instrumentation\n- documentation-engineer: Helps document the adde"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a42b5df1-f0c0-46e1-9490-ea0a0ee0887e",
        "latencyMs": 28,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: add instrumentation to track request latency\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,code-reviewer,documentation-engineer\n\nRationale:\n- datadog-specialist: Direct expertise in request latency tracking, observability, and APM\n- backend-developer: Technical implementation of instrumentation\n- microservices-architect: Architectural perspective on distributed tracing\n- code-reviewer: Ensures quality and best practices of instrumentation\n- documentation-engineer: Helps document the adde",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - instrumentation",
          "vars": {
            "user_request": "add instrumentation to track request latency"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 26,
        "vars": {
          "user_request": "add instrumentation to track request latency"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010376,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- qa-expert: Direct match for quality assurance checks\n- test-automator: Supports automated testing processes\n- code-reviewer: Ensures code quality and best practices\n- development-orchestrator: Can coordinate complex QA workflows\n- research-analyst: Can help research best QA methodologies and tools"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e57eb815-c89a-481c-9052-9d1026319f69",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: run quality assurance checks\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "qa-expert,test-automator,code-reviewer,development-orchestrator,research-analyst\n\nRationale:\n- qa-expert: Direct match for quality assurance checks\n- test-automator: Supports automated testing processes\n- code-reviewer: Ensures code quality and best practices\n- development-orchestrator: Can coordinate complex QA workflows\n- research-analyst: Can help research best QA methodologies and tools",
          "tokenUsage": {
            "cached": 913,
            "total": 913
          },
          "finishReason": "stop",
          "cost": 0.0010376
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Synonym for testing - QA",
          "vars": {
            "user_request": "run quality assurance checks"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "test-automator",
            "qa-expert"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 27,
        "vars": {
          "user_request": "run quality assurance checks"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010512,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- backend-developer: Can help diagnose database query performance issues\n- postgres-pro: Specialized in database performance optimization\n- debugger: Skilled in systematic problem resolution and performance troubleshooting\n- datadog-specialist: Can help with monitoring and performance analysis\n- research-analyst: Can help investigate best practices and potential optimization strategies"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "67082d82-57b7-4a8e-bd4d-fc8afa1205b0",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my database queries are taking too long\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,debugger,datadog-specialist,research-analyst\n\nRationale:\n- backend-developer: Can help diagnose database query performance issues\n- postgres-pro: Specialized in database performance optimization\n- debugger: Skilled in systematic problem resolution and performance troubleshooting\n- datadog-specialist: Can help with monitoring and performance analysis\n- research-analyst: Can help investigate best practices and potential optimization strategies",
          "tokenUsage": {
            "cached": 918,
            "total": 918
          },
          "finishReason": "stop",
          "cost": 0.0010512
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Indirect reference - query performance",
          "vars": {
            "user_request": "my database queries are taking too long"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "postgres-pro"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 28,
        "vars": {
          "user_request": "my database queries are taking too long"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- microservices-architect: Directly relevant for tracing requests across microservices, understanding service boundaries and communication\n- datadog-specialist: Specialized in distributed tracing, observability, and tracking requests across services\n- backend-developer: Understands server-side logic and inter-service communication\n- debugger: Helpful for troubl"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e90d0720-a342-4787-ab04-6c63ee39b311",
        "latencyMs": 28,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: trace requests across my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "microservices-architect,datadog-specialist,backend-developer,debugger,documentation-engineer\n\nRationale:\n- microservices-architect: Directly relevant for tracing requests across microservices, understanding service boundaries and communication\n- datadog-specialist: Specialized in distributed tracing, observability, and tracking requests across services\n- backend-developer: Understands server-side logic and inter-service communication\n- debugger: Helpful for troubl",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Indirect reference - distributed tracing",
          "vars": {
            "user_request": "trace requests across my microservices"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 29,
        "vars": {
          "user_request": "trace requests across my microservices"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- kubernetes-specialist: Direct match for container orchestration at scale\n- aws-cloud-specialist: Cloud infrastructure expertise for containerized applications\n- microservices-architect: Relevant for designing scalable distributed systems\n- development-orchestrator: Helps manage complex deployment workflows\n- documentation-engineer: Ensures proper documentation for scalable"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2702f070-b450-439d-8844-94b8e7dd3433",
        "latencyMs": 30,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: manage my containerized applications at scale\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator,documentation-engineer\n\nRationale:\n- kubernetes-specialist: Direct match for container orchestration at scale\n- aws-cloud-specialist: Cloud infrastructure expertise for containerized applications\n- microservices-architect: Relevant for designing scalable distributed systems\n- development-orchestrator: Helps manage complex deployment workflows\n- documentation-engineer: Ensures proper documentation for scalable",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Indirect reference - container orchestration",
          "vars": {
            "user_request": "manage my containerized applications at scale"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "kubernetes-specialist"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 30,
        "vars": {
          "user_request": "manage my containerized applications at scale"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010528,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: debugger\n\nRationale:\n- postgres-pro: Direct expert for PostgreSQL database index optimization\n- backend-developer: Provides server-side database integration perspective\n- research-analyst: Can help find best practices and research index optimization strategies\n- code-reviewer: Can analyze index design for performance and efficiency\n- debugger: Helpful for identifying potential performance bottlenecks related to indexing"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "cedfc5d4-8d2d-49f0-9e85-43f639382dd9",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize postgres database indexes\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst,code-reviewer,debugger\n\nRationale:\n- postgres-pro: Direct expert for PostgreSQL database index optimization\n- backend-developer: Provides server-side database integration perspective\n- research-analyst: Can help find best practices and research index optimization strategies\n- code-reviewer: Can analyze index design for performance and efficiency\n- debugger: Helpful for identifying potential performance bottlenecks related to indexing",
          "tokenUsage": {
            "cached": 916,
            "total": 916
          },
          "finishReason": "length",
          "cost": 0.0010528
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Typo - postgres vs postgresql",
          "vars": {
            "user_request": "optimize postgres database indexes"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "postgres-pro"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 31,
        "vars": {
          "user_request": "optimize postgres database indexes"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010344,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: backend-developer\n\nRationale:\n- kubernetes-specialist: Direct match for K8s cluster deployment\n- aws-cloud-specialist: Helpful for cloud infrastructure considerations\n- development-orchestrator: Manages complex deployment workflow\n- documentation-engineer: Ensures deployment process is well-documented\n- backend-developer: Provides technical implementation perspective"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "042186bc-1085-4483-a3af-067da9b0370a",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to k8s cluster\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,documentation-engineer,backend-developer\n\nRationale:\n- kubernetes-specialist: Direct match for K8s cluster deployment\n- aws-cloud-specialist: Helpful for cloud infrastructure considerations\n- development-orchestrator: Manages complex deployment workflow\n- documentation-engineer: Ensures deployment process is well-documented\n- backend-developer: Provides technical implementation perspective",
          "tokenUsage": {
            "cached": 913,
            "total": 913
          },
          "finishReason": "stop",
          "cost": 0.0010344
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Typo - k8s abbreviation",
          "vars": {
            "user_request": "deploy to k8s cluster"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "kubernetes-specialist"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 32,
        "vars": {
          "user_request": "deploy to k8s cluster"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007488,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.75,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6434fdff-7afa-4133-b0a8-e97692b49eec",
        "latencyMs": 28,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 840,
            "total": 840
          },
          "finishReason": "stop",
          "cost": 0.0007488
        },
        "score": 0.75,
        "success": false,
        "testCase": {
          "description": "Common abbreviation - API",
          "vars": {
            "user_request": "build REST API endpoints"
          },
          "metadata": {
            "category": "abbreviation",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "api-designer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 33,
        "vars": {
          "user_request": "build REST API endpoints"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- datadog-specialist: Direct match for Datadog traces debugging\n- debugger: Core troubleshooting and error analysis skills\n- backend-developer: Relevant for understanding system architecture and trace context\n- aws-cloud-specialist: Helpful for potential cloud-related tracing context\n- research-analyst: Can assist in finding relevant documentation"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "31444975-e584-44ef-8445-c282e89bf971",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: debug production error using Datadog traces\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,debugger,backend-developer,aws-cloud-specialist,research-analyst\n\nRationale:\n- datadog-specialist: Direct match for Datadog traces debugging\n- debugger: Core troubleshooting and error analysis skills\n- backend-developer: Relevant for understanding system architecture and trace context\n- aws-cloud-specialist: Helpful for potential cloud-related tracing context\n- research-analyst: Can assist in finding relevant documentation",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Debug production issue with monitoring",
          "vars": {
            "user_request": "debug production error using Datadog traces"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "debugger",
            "datadog-specialist"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 34,
        "vars": {
          "user_request": "debug production error using Datadog traces"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010312000000000001,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- backend-developer: Core expertise for database schema migration\n- postgres-pro: Specific database migration and schema expertise\n- test-automator: Ensures test pass requirement is addressed\n- development-orchestrator: Helps coordinate complex migration process\n- code-reviewer: Validates migration approach and ensures quality"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "75d9386c-058c-407e-9667-2396119cccf9",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: migrate database schema and ensure tests pass\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,test-automator,development-orchestrator,code-reviewer\n\nRationale:\n- backend-developer: Core expertise for database schema migration\n- postgres-pro: Specific database migration and schema expertise\n- test-automator: Ensures test pass requirement is addressed\n- development-orchestrator: Helps coordinate complex migration process\n- code-reviewer: Validates migration approach and ensures quality",
          "tokenUsage": {
            "cached": 913,
            "total": 913
          },
          "finishReason": "stop",
          "cost": 0.0010312000000000001
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Migration with testing",
          "vars": {
            "user_request": "migrate database schema and ensure tests pass"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "postgres-pro",
            "test-automator"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 35,
        "vars": {
          "user_request": "migrate database schema and ensure tests pass"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001044,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: development-orchestrator\n\nRationale:\n- aws-cloud-specialist: Core expertise in AWS infrastructure setup\n- datadog-specialist: Covers monitoring requirements\n- microservices-architect: Helps design scalable infrastructure\n- documentation-engineer: Ensures proper documentation of infrastructure\n- development-orchestrator: Helps coordinate complex infrastructure deployment"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "4ff64613-dc44-445b-9c18-5fb03bf1c90b",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up AWS infrastructure with monitoring and logging\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "aws-cloud-specialist,datadog-specialist,microservices-architect,documentation-engineer,development-orchestrator\n\nRationale:\n- aws-cloud-specialist: Core expertise in AWS infrastructure setup\n- datadog-specialist: Covers monitoring requirements\n- microservices-architect: Helps design scalable infrastructure\n- documentation-engineer: Ensures proper documentation of infrastructure\n- development-orchestrator: Helps coordinate complex infrastructure deployment",
          "tokenUsage": {
            "cached": 917,
            "total": 917
          },
          "finishReason": "stop",
          "cost": 0.001044
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Cloud infrastructure setup",
          "vars": {
            "user_request": "set up AWS infrastructure with monitoring and logging"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "aws-cloud-specialist",
            "datadog-specialist"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 36,
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010264,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- django-developer: Direct expertise in Django models and authentication\n- backend-developer: Server-side logic and authentication implementation\n- python-pro: Python-specific best practices for model design\n- code-reviewer: Ensure quality and security of authentication models\n- documentation-engineer: Help document the authentication model structure"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "558e94f9-65df-43d0-a162-a0e16d00863a",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Django models for user authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,code-reviewer,documentation-engineer\n\nRationale:\n- django-developer: Direct expertise in Django models and authentication\n- backend-developer: Server-side logic and authentication implementation\n- python-pro: Python-specific best practices for model design\n- code-reviewer: Ensure quality and security of authentication models\n- documentation-engineer: Help document the authentication model structure",
          "tokenUsage": {
            "cached": 911,
            "total": 911
          },
          "finishReason": "stop",
          "cost": 0.0010264
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Django-specific request",
          "vars": {
            "user_request": "create Django models for user authentication"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "django-developer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 37,
        "vars": {
          "user_request": "create Django models for user authentication"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- api-designer: Perfect for FastAPI application design and RESTful best practices\n- backend-developer: Ideal for server-side logic and API implementation\n- python-pro: Essential for Python-specific implementation details\n- documentation-engineer: Helpful for creating comprehensive API documentation\n- code-reviewer: Ensures code quality and best practices for the Fast"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7f36003a-6583-46c8-a1a2-fea3814d0cb6",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build FastAPI application with async endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,python-pro,documentation-engineer,code-reviewer\n\nRationale:\n- api-designer: Perfect for FastAPI application design and RESTful best practices\n- backend-developer: Ideal for server-side logic and API implementation\n- python-pro: Essential for Python-specific implementation details\n- documentation-engineer: Helpful for creating comprehensive API documentation\n- code-reviewer: Ensures code quality and best practices for the Fast",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "FastAPI development",
          "vars": {
            "user_request": "build FastAPI application with async endpoints"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "python-pro",
            "backend-developer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 38,
        "vars": {
          "user_request": "build FastAPI application with async endpoints"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nReasoning:\n- debugger: Direct match for crash debugging\n- backend-developer: Can help diagnose startup issues\n- python-pro: Specific language expertise for potential Python-related problems\n- code-reviewer: Can analyze potential code quality/configuration issues\n- research-analyst: Can help investigate potential library/framework compatibility problems\n\nThe selection covers technical troubleshooting, code"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "62efbd08-681b-4076-b042-6d1f81fce54c",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my application crashes on startup, help debug\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,backend-developer,python-pro,code-reviewer,research-analyst\n\nReasoning:\n- debugger: Direct match for crash debugging\n- backend-developer: Can help diagnose startup issues\n- python-pro: Specific language expertise for potential Python-related problems\n- code-reviewer: Can analyze potential code quality/configuration issues\n- research-analyst: Can help investigate potential library/framework compatibility problems\n\nThe selection covers technical troubleshooting, code",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Error debugging",
          "vars": {
            "user_request": "my application crashes on startup, help debug"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "debugger"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 39,
        "vars": {
          "user_request": "my application crashes on startup, help debug"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nReasoning:\n- \"tests are failing\" suggests a need for debugging and test resolution\n- debugger is ideal for systematic troubleshooting and error analysis\n- test-automator can help with test framework and automation insights\n- code-reviewer can provide additional perspective on potential code quality issues causing test failures\n\nThe response is concise, directly addresses the core problem of failing tests, and selects agents most likely to provide"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "55cdf306-0798-4519-9d0a-daa5dfc4c312",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tests are failing, help me fix them\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,test-automator,code-reviewer\n\nReasoning:\n- \"tests are failing\" suggests a need for debugging and test resolution\n- debugger is ideal for systematic troubleshooting and error analysis\n- test-automator can help with test framework and automation insights\n- code-reviewer can provide additional perspective on potential code quality issues causing test failures\n\nThe response is concise, directly addresses the core problem of failing tests, and selects agents most likely to provide",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Test failure debugging",
          "vars": {
            "user_request": "tests are failing, help me fix them"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "debugger",
            "test-automator"
          ],
          "priority": "MULTIPLE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 40,
        "vars": {
          "user_request": "tests are failing, help me fix them"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: To identify performance bottlenecks in an API, the most relevant agents are:\n\ndatadog-specialist, microservices-architect\n\nRationale:\n- datadog-specialist: Provides observability and performance monitoring expertise\n- backend-developer: Understands server-side performance optimization\n- debugger: Can systematically diagnose performance issues\n- code-reviewer: Analyzes code for performance inefficiencies"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a5cba84e-962d-4be5-a16e-f0338b4f8dfc",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: identify performance bottleneck in my API\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "To identify performance bottlenecks in an API, the most relevant agents are:\n\ndatadog-specialist,backend-developer,debugger,code-reviewer,microservices-architect\n\nRationale:\n- datadog-specialist: Provides observability and performance monitoring expertise\n- backend-developer: Understands server-side performance optimization\n- debugger: Can systematically diagnose performance issues\n- code-reviewer: Analyzes code for performance inefficiencies",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Performance bottleneck",
          "vars": {
            "user_request": "identify performance bottleneck in my API"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "backend-developer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 41,
        "vars": {
          "user_request": "identify performance bottleneck in my API"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009304000000000001,
        "error": "PROACTIVE agent test-automator should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "PROACTIVE agent test-automator should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- code-reviewer: Directly matches the need to review a pull request for quality\n- backend-developer: Can provide technical insights into server-side implementation\n- documentation-engineer: Can help ensure documentation and code standards are met during review"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent test-automator should trigger but was not suggested"
            }
          ]
        },
        "id": "0dd53ed6-24c5-4277-a6f7-d9385f6e92e2",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review this pull request for quality\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,backend-developer,documentation-engineer\n\nRationale:\n- code-reviewer: Directly matches the need to review a pull request for quality\n- backend-developer: Can provide technical insights into server-side implementation\n- documentation-engineer: Can help ensure documentation and code standards are met during review",
          "tokenUsage": {
            "cached": 887,
            "total": 887
          },
          "finishReason": "stop",
          "cost": 0.0009304000000000001
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "Code review request",
          "vars": {
            "user_request": "review this pull request for quality"
          },
          "metadata": {
            "category": "code-review",
            "expected_strategy": "llm"
          },
          "expected_agents": [
            "code-reviewer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 42,
        "vars": {
          "user_request": "review this pull request for quality"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010384,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- api-designer: Core expertise in API design and documentation\n- documentation-engineer: Technical writing and documentation specialist\n- backend-developer: Understands server-side logic and API architecture\n- research-analyst: Can help gather best practices and research API documentation standards\n- code-reviewer: Can validate API documentation quality and consistency"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "feff1d72-b100-4a5b-838a-67693b5f3e3f",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: write API documentation for these endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,documentation-engineer,backend-developer,research-analyst,code-reviewer\n\nRationale:\n- api-designer: Core expertise in API design and documentation\n- documentation-engineer: Technical writing and documentation specialist\n- backend-developer: Understands server-side logic and API architecture\n- research-analyst: Can help gather best practices and research API documentation standards\n- code-reviewer: Can validate API documentation quality and consistency",
          "tokenUsage": {
            "cached": 914,
            "total": 914
          },
          "finishReason": "stop",
          "cost": 0.0010384
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Documentation writing",
          "vars": {
            "user_request": "write API documentation for these endpoints"
          },
          "metadata": {
            "category": "documentation",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "documentation-engineer"
          ],
          "priority": "SHOULD",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 43,
        "vars": {
          "user_request": "write API documentation for these endpoints"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- datadog-specialist: Direct match for Datadog metrics expertise\n- backend-developer: Relevant for implementing custom metrics integration\n- aws-cloud-specialist: Helpful for cloud-based metric sending infrastructure\n- documentation-engineer: Can help document the metrics implementation\n- research-analyst: Can assist in finding best practices for metric collection"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "56a3b0f2-0fe5-4a13-838d-7a9f87ced52b",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: send custom metrics to Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,aws-cloud-specialist,documentation-engineer,research-analyst\n\nRationale:\n- datadog-specialist: Direct match for Datadog metrics expertise\n- backend-developer: Relevant for implementing custom metrics integration\n- aws-cloud-specialist: Helpful for cloud-based metric sending infrastructure\n- documentation-engineer: Can help document the metrics implementation\n- research-analyst: Can assist in finding best practices for metric collection",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Metrics collection",
          "vars": {
            "user_request": "send custom metrics to Datadog"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 44,
        "vars": {
          "user_request": "send custom metrics to Datadog"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- datadog-specialist: Direct match for centralized logging with Datadog expertise\n- aws-cloud-specialist: Helpful for cloud infrastructure logging setup\n- backend-developer: Supports technical implementation of logging strategy\n- documentation-engineer: Can help document logging architecture and processes\n- research-analyst: Can assist in researching best practices for"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2778d3bf-e090-47e8-9165-41e5deac6b0f",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: centralize logging with Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,aws-cloud-specialist,backend-developer,documentation-engineer,research-analyst\n\nRationale:\n- datadog-specialist: Direct match for centralized logging with Datadog expertise\n- aws-cloud-specialist: Helpful for cloud infrastructure logging setup\n- backend-developer: Supports technical implementation of logging strategy\n- documentation-engineer: Can help document logging architecture and processes\n- research-analyst: Can assist in researching best practices for",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Log aggregation",
          "vars": {
            "user_request": "centralize logging with Datadog"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 45,
        "vars": {
          "user_request": "centralize logging with Datadog"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: documentation-engineer\n\nRationale:\n- datadog-specialist: Direct expertise in OpenTelemetry and observability\n- backend-developer: Technical implementation perspective\n- microservices-architect: Relevant for distributed tracing and instrumentation\n- research-analyst: Can help find best practices and implementation details\n- documentation-engineer: Can assist with documenting OpenTelemet"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "fc59ea43-9f94-4e84-943a-c9f9fe6b1446",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: instrument application with OpenTelemetry\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,research-analyst,documentation-engineer\n\nRationale:\n- datadog-specialist: Direct expertise in OpenTelemetry and observability\n- backend-developer: Technical implementation perspective\n- microservices-architect: Relevant for distributed tracing and instrumentation\n- research-analyst: Can help find best practices and implementation details\n- documentation-engineer: Can assist with documenting OpenTelemet",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "OpenTelemetry setup",
          "vars": {
            "user_request": "instrument application with OpenTelemetry"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "datadog-specialist"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 46,
        "vars": {
          "user_request": "instrument application with OpenTelemetry"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.001056,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: code-reviewer\n\nRationale:\n- backend-developer: Core expertise for implementing server-side read model projections\n- eventsourcing-expert: Specific expertise in event sourcing patterns and projections\n- python-pro: Technical implementation skills in Python\n- research-analyst: Can help research best practices and libraries for event store projections\n- code-reviewer:"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ef1144b1-4b7a-4d82-9519-8ee935dd3533",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement read model projections from event store\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,eventsourcing-expert,python-pro,research-analyst,code-reviewer\n\nRationale:\n- backend-developer: Core expertise for implementing server-side read model projections\n- eventsourcing-expert: Specific expertise in event sourcing patterns and projections\n- python-pro: Technical implementation skills in Python\n- research-analyst: Can help research best practices and libraries for event store projections\n- code-reviewer:",
          "tokenUsage": {
            "cached": 920,
            "total": 920
          },
          "finishReason": "length",
          "cost": 0.001056
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Projection implementation",
          "vars": {
            "user_request": "implement read model projections from event store"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "eventsourcing-expert"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 47,
        "vars": {
          "user_request": "implement read model projections from event store"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010544,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: python-pro\n\nRationale:\n- backend-developer: Core expertise in server-side logic and system architecture\n- eventsourcing-expert: Direct match for domain events and event sourcing patterns\n- microservices-architect: Relevant for designing distributed event-driven systems\n- documentation-engineer: Will help document the domain event design\n- python-pro:"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "82b8132d-d47d-477c-accf-a06921afc176",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design domain events for order aggregate\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,eventsourcing-expert,microservices-architect,documentation-engineer,python-pro\n\nRationale:\n- backend-developer: Core expertise in server-side logic and system architecture\n- eventsourcing-expert: Direct match for domain events and event sourcing patterns\n- microservices-architect: Relevant for designing distributed event-driven systems\n- documentation-engineer: Will help document the domain event design\n- python-pro:",
          "tokenUsage": {
            "cached": 918,
            "total": 918
          },
          "finishReason": "length",
          "cost": 0.0010544
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Domain events design",
          "vars": {
            "user_request": "design domain events for order aggregate"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "eventsourcing-expert"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 48,
        "vars": {
          "user_request": "design domain events for order aggregate"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010568,
        "error": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- CQRS (Command Query Responsibility Segregation) is an architectural pattern\n- Requires backend architecture design (backend-developer)\n- Involves complex system design considerations (microservices-architect)\n- Needs code quality review and best practices (code-reviewer)\n- Will require comprehensive documentation (documentation-engineer)\n-"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested"
            }
          ]
        },
        "id": "75983cd0-b68c-4fab-ab27-652e49eb83a1",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement CQRS pattern for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,microservices-architect,code-reviewer,documentation-engineer,research-analyst\n\nRationale:\n- CQRS (Command Query Responsibility Segregation) is an architectural pattern\n- Requires backend architecture design (backend-developer)\n- Involves complex system design considerations (microservices-architect)\n- Needs code quality review and best practices (code-reviewer)\n- Will require comprehensive documentation (documentation-engineer)\n-",
          "tokenUsage": {
            "cached": 921,
            "total": 921
          },
          "finishReason": "length",
          "cost": 0.0010568
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "CQRS pattern",
          "vars": {
            "user_request": "implement CQRS pattern for my application"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "expected_agents": [
            "eventsourcing-expert"
          ],
          "priority": "MUST",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 49,
        "vars": {
          "user_request": "implement CQRS pattern for my application"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010544,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: research-analyst\n\nRationale:\n- The request \"what's the weather today?\" suggests a need for information retrieval\n- research-analyst is best suited to:\n  1. Look up current weather information\n  2. Potentially find appropriate weather API or service\n  3. Gather relevant data sources\n  4. Provide a comprehensive weather report\n\nWhile other agents like api-designer or backend-developer could technically help, the research-analyst is most directly aligne"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6eeef137-0d21-48b5-9b32-cf0189dd979d",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the weather today?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst\n\nRationale:\n- The request \"what's the weather today?\" suggests a need for information retrieval\n- research-analyst is best suited to:\n  1. Look up current weather information\n  2. Potentially find appropriate weather API or service\n  3. Gather relevant data sources\n  4. Provide a comprehensive weather report\n\nWhile other agents like api-designer or backend-developer could technically help, the research-analyst is most directly aligne",
          "tokenUsage": {
            "cached": 918,
            "total": 918
          },
          "finishReason": "length",
          "cost": 0.0010544
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Completely unrelated request",
          "vars": {
            "user_request": "what's the weather today?"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 50,
        "vars": {
          "user_request": "what's the weather today?"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0009328,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: context-manager\n\nRationale:\n- The request \"tell me a joke\" is a simple conversational task\n- No specific technical domain is mentioned\n- Context-manager is a generalist agent that can help manage the interaction and context for generating a joke\n- Other specialized technical agents are not relevant for this casual request"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "047f3036-14af-4d69-ac57-8db3a8d595c7",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tell me a joke\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "context-manager\n\nRationale:\n- The request \"tell me a joke\" is a simple conversational task\n- No specific technical domain is mentioned\n- Context-manager is a generalist agent that can help manage the interaction and context for generating a joke\n- Other specialized technical agents are not relevant for this casual request",
          "tokenUsage": {
            "cached": 886,
            "total": 886
          },
          "finishReason": "stop",
          "cost": 0.0009328
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "General conversation",
          "vars": {
            "user_request": "tell me a joke"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 51,
        "vars": {
          "user_request": "tell me a joke"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0010552,
        "error": "Should have returned NONE",
        "gradingResult": {
          "pass": false,
          "score": 0.25,
          "reason": "Should have returned NONE",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Response contains invalid characters or extra text"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: claude-specialist\n\nRationale:\n- research-analyst: Can help explore philosophical perspectives, research historical and contemporary views on life's meaning\n- trend-analyst: Can provide insights into existential thinking, philosophical trends, and interpretative frameworks\n- claude-specialist: As an AI trained on broad knowledge, can help discuss philosophical concepts and provide nuanced perspectives on existential questions\n\nThe request is a profound philosophical query about meaning and purpose, which"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Should have returned NONE"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6ef2fa92-b8bf-41f7-9a48-7322828de957",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the meaning of life?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
        },
        "promptId": "4ff93becd19f72ff75ee28ab602376378bc816c942349b2039741e8ffe47f344",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,trend-analyst,claude-specialist\n\nRationale:\n- research-analyst: Can help explore philosophical perspectives, research historical and contemporary views on life's meaning\n- trend-analyst: Can provide insights into existential thinking, philosophical trends, and interpretative frameworks\n- claude-specialist: As an AI trained on broad knowledge, can help discuss philosophical concepts and provide nuanced perspectives on existential questions\n\nThe request is a profound philosophical query about meaning and purpose, which",
          "tokenUsage": {
            "cached": 919,
            "total": 919
          },
          "finishReason": "length",
          "cost": 0.0010552
        },
        "score": 0.25,
        "success": false,
        "testCase": {
          "description": "Non-technical question",
          "vars": {
            "user_request": "what's the meaning of life?"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "expected_agents": [
            "NONE"
          ],
          "priority": "NONE",
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 52,
        "vars": {
          "user_request": "what's the meaning of life?"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      }
    ],
    "stats": {
      "successes": 0,
      "failures": 53,
      "errors": 0,
      "tokenUsage": {
        "prompt": 0,
        "completion": 0,
        "cached": 48374,
        "total": 48374,
        "numRequests": 53,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      }
    }
  },
  "config": {
    "tags": {},
    "description": "Agent Discovery Hook - LLM Matching Evaluation",
    "prompts": [
      "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nReturn ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n"
    ],
    "providers": [
      {
        "id": "anthropic:claude-3-5-haiku-20241022",
        "config": {
          "temperature": 0,
          "max_tokens": 100
        }
      }
    ],
    "tests": [
      {
        "description": "PostgreSQL query optimization - clear database request",
        "vars": {
          "user_request": "optimize this PostgreSQL query"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "postgres-pro"
        ],
        "priority": "MUST"
      },
      {
        "description": "Event sourcing aggregate design",
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "eventsourcing-expert"
        ],
        "priority": "MUST"
      },
      {
        "description": "Datadog APM tracing setup",
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "Test automation framework setup",
        "vars": {
          "user_request": "help me set up automated testing for my application"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "test-automator"
        ],
        "priority": "MUST"
      },
      {
        "description": "API endpoint design",
        "vars": {
          "user_request": "design RESTful API endpoints for user management"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "api-designer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Kubernetes deployment configuration",
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "kubernetes-specialist"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Python Django application development",
        "vars": {
          "user_request": "build a Django REST API with authentication"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "django-developer",
          "python-pro"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Security vulnerability assessment",
        "vars": {
          "user_request": "audit my application for security vulnerabilities"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "qa-expert"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Performance optimization request",
        "vars": {
          "user_request": "my API is slow, help me optimize performance"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "backend-developer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Documentation research request",
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "research-analyst"
        ],
        "priority": "MUST"
      },
      {
        "description": "Ambiguous fix request",
        "vars": {
          "user_request": "fix this"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      },
      {
        "description": "Vague improvement request",
        "vars": {
          "user_request": "make it better"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      },
      {
        "description": "Generic help request",
        "vars": {
          "user_request": "help"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      },
      {
        "description": "Vague check request",
        "vars": {
          "user_request": "check this code"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "code-reviewer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Generic review request",
        "vars": {
          "user_request": "review my work"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "code-reviewer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Ambiguous analyze request",
        "vars": {
          "user_request": "analyze this"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      },
      {
        "description": "Full stack implementation with testing",
        "vars": {
          "user_request": "implement user registration API with tests and documentation"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "backend-developer",
          "test-automator",
          "documentation-engineer"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "Database schema with event sourcing",
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "postgres-pro",
          "eventsourcing-expert"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "Kubernetes deployment with monitoring",
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "kubernetes-specialist",
          "datadog-specialist"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "API development with security testing",
        "vars": {
          "user_request": "build REST API with security audit and tests"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "api-designer",
          "qa-expert",
          "test-automator"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "How does framework work",
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "research-analyst"
        ],
        "priority": "MUST"
      },
      {
        "description": "Best practices inquiry",
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "research-analyst"
        ],
        "priority": "MUST"
      },
      {
        "description": "Documentation lookup",
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "research-analyst"
        ],
        "priority": "MUST"
      },
      {
        "description": "Library research",
        "vars": {
          "user_request": "research ddtrace library features"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "research-analyst"
        ],
        "priority": "MUST"
      },
      {
        "description": "API reference lookup",
        "vars": {
          "user_request": "find API reference for Datadog metrics submission"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "research-analyst"
        ],
        "priority": "MUST"
      },
      {
        "description": "Synonym for monitoring - observability",
        "vars": {
          "user_request": "implement observability for my microservices"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "Synonym for monitoring - instrumentation",
        "vars": {
          "user_request": "add instrumentation to track request latency"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "Synonym for testing - QA",
        "vars": {
          "user_request": "run quality assurance checks"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "test-automator",
          "qa-expert"
        ],
        "priority": "MUST"
      },
      {
        "description": "Indirect reference - query performance",
        "vars": {
          "user_request": "my database queries are taking too long"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "postgres-pro"
        ],
        "priority": "MUST"
      },
      {
        "description": "Indirect reference - distributed tracing",
        "vars": {
          "user_request": "trace requests across my microservices"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "Indirect reference - container orchestration",
        "vars": {
          "user_request": "manage my containerized applications at scale"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "kubernetes-specialist"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Typo - postgres vs postgresql",
        "vars": {
          "user_request": "optimize postgres database indexes"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "postgres-pro"
        ],
        "priority": "MUST"
      },
      {
        "description": "Typo - k8s abbreviation",
        "vars": {
          "user_request": "deploy to k8s cluster"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "kubernetes-specialist"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Common abbreviation - API",
        "vars": {
          "user_request": "build REST API endpoints"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "api-designer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Debug production issue with monitoring",
        "vars": {
          "user_request": "debug production error using Datadog traces"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "debugger",
          "datadog-specialist"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "Migration with testing",
        "vars": {
          "user_request": "migrate database schema and ensure tests pass"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "postgres-pro",
          "test-automator"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "Cloud infrastructure setup",
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "aws-cloud-specialist",
          "datadog-specialist"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "Django-specific request",
        "vars": {
          "user_request": "create Django models for user authentication"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "django-developer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "FastAPI development",
        "vars": {
          "user_request": "build FastAPI application with async endpoints"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "python-pro",
          "backend-developer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Error debugging",
        "vars": {
          "user_request": "my application crashes on startup, help debug"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "debugger"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Test failure debugging",
        "vars": {
          "user_request": "tests are failing, help me fix them"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "debugger",
          "test-automator"
        ],
        "priority": "MULTIPLE"
      },
      {
        "description": "Performance bottleneck",
        "vars": {
          "user_request": "identify performance bottleneck in my API"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "backend-developer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Code review request",
        "vars": {
          "user_request": "review this pull request for quality"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm"
        },
        "expected_agents": [
          "code-reviewer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Documentation writing",
        "vars": {
          "user_request": "write API documentation for these endpoints"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "documentation-engineer"
        ],
        "priority": "SHOULD"
      },
      {
        "description": "Metrics collection",
        "vars": {
          "user_request": "send custom metrics to Datadog"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "Log aggregation",
        "vars": {
          "user_request": "centralize logging with Datadog"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "OpenTelemetry setup",
        "vars": {
          "user_request": "instrument application with OpenTelemetry"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "datadog-specialist"
        ],
        "priority": "MUST"
      },
      {
        "description": "Projection implementation",
        "vars": {
          "user_request": "implement read model projections from event store"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "eventsourcing-expert"
        ],
        "priority": "MUST"
      },
      {
        "description": "Domain events design",
        "vars": {
          "user_request": "design domain events for order aggregate"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "eventsourcing-expert"
        ],
        "priority": "MUST"
      },
      {
        "description": "CQRS pattern",
        "vars": {
          "user_request": "implement CQRS pattern for my application"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        },
        "expected_agents": [
          "eventsourcing-expert"
        ],
        "priority": "MUST"
      },
      {
        "description": "Completely unrelated request",
        "vars": {
          "user_request": "what's the weather today?"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      },
      {
        "description": "General conversation",
        "vars": {
          "user_request": "tell me a joke"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      },
      {
        "description": "Non-technical question",
        "vars": {
          "user_request": "what's the meaning of life?"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        },
        "expected_agents": [
          "NONE"
        ],
        "priority": "NONE"
      }
    ],
    "scenarios": [],
    "env": {},
    "sharing": false,
    "defaultTest": {
      "assert": [
        {
          "type": "javascript",
          "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
        },
        {
          "type": "javascript",
          "value": "// Get expected agents from test metadata\nconst expected = context.vars.expected_agents || [];\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
        }
      ],
      "vars": {},
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "results/latest.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {
      "maxConcurrency": 10,
      "cache": true,
      "showProgressBar": true
    }
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.119.9",
    "nodeVersion": "v25.1.0",
    "platform": "darwin",
    "arch": "x64",
    "exportedAt": "2025-11-21T11:08:14.847Z",
    "evaluationCreatedAt": "2025-11-21T11:08:14.379Z"
  }
}