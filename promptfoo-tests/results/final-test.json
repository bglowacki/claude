{
  "evalId": "eval-1Ga-2025-11-21T11:56:19",
  "results": {
    "version": 3,
    "timestamp": "2025-11-21T11:56:19.471Z",
    "prompts": [
      {
        "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
        "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
        "id": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "provider": "anthropic:claude-3-5-haiku-20241022",
        "metrics": {
          "score": 162.9249999999999,
          "testPassCount": 0,
          "testFailCount": 198,
          "testErrorCount": 0,
          "assertPassCount": 579,
          "assertFailCount": 213,
          "totalLatencyMs": 5513,
          "tokenUsage": {
            "prompt": 0,
            "completion": 0,
            "cached": 177068,
            "total": 177068,
            "numRequests": 198,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0.15563840000000007
        }
      }
    ],
    "results": [
      {
        "cost": 0.0007800000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "9dfa1b99-7b6a-4536-bfa3-7e4d75f5fc7c",
        "latencyMs": 47,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,code-reviewer,research-analyst,debugger",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007800000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query",
            "expected_agents": "postgres-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 0,
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "postgres-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007800000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "670814b8-3f6e-48a9-8c62-956cff9c757b",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,code-reviewer,research-analyst,debugger",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007800000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 1,
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007800000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "4f201d79-a889-41b3-a7d4-463fb8c49360",
        "latencyMs": 40,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,code-reviewer,research-analyst,debugger",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007800000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query",
            "expected_agents": "code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 2,
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007800000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, code-reviewer, research-analyst, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7d9aec8b-fde6-481a-99a8-4d192adf89b8",
        "latencyMs": 52,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize this PostgreSQL query\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,code-reviewer,research-analyst,debugger",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007800000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "PostgreSQL query optimization - clear database request",
          "vars": {
            "user_request": "optimize this PostgreSQL query",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 3,
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008088,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "0acc7c2d-0b58-44c3-840b-01ec3592e175",
        "latencyMs": 61,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 903,
            "total": 903
          },
          "finishReason": "stop",
          "cost": 0.0008088
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system",
            "expected_agents": "eventsourcing-expert",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 4,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "eventsourcing-expert",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008088,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "4591bc04-92bb-4abe-8340-4894f104f41a",
        "latencyMs": 57,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 903,
            "total": 903
          },
          "finishReason": "stop",
          "cost": 0.0008088
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 5,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008088,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1b5b694e-763c-4e39-a939-854ccc49fc69",
        "latencyMs": 66,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 903,
            "total": 903
          },
          "finishReason": "stop",
          "cost": 0.0008088
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 6,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008088,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [eventsourcing-expert, backend-developer, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c252e52b-4762-40a8-beea-13fe6aae7723",
        "latencyMs": 70,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me design an aggregate for my event sourcing system\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 903,
            "total": 903
          },
          "finishReason": "stop",
          "cost": 0.0008088
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Event sourcing aggregate design",
          "vars": {
            "user_request": "help me design an aggregate for my event sourcing system",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 7,
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "876bfcbc-44c1-47de-beb4-7a028fac5a8d",
        "latencyMs": 74,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 8,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "390ef27d-2c86-4b44-8282-518517296551",
        "latencyMs": 79,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 9,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "5c0ad1cb-83f3-4952-8757-6df6341ae15b",
        "latencyMs": 49,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 10,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, python-pro, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f92ae6c0-b6cf-4ca8-8ff7-9c1c63df9e14",
        "latencyMs": 49,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up Datadog APM tracing in my Python app\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,python-pro,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Datadog APM tracing setup",
          "vars": {
            "user_request": "set up Datadog APM tracing in my Python app",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 11,
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c9fcd3e9-cb01-4ff2-9e0b-c8aaf59f4d79",
        "latencyMs": 45,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application",
            "expected_agents": "test-automator",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 12,
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "test-automator",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ec5f5b28-e9f0-4f34-b7da-d3495cbb8eda",
        "latencyMs": 44,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application",
            "expected_agents": "qa-expert",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 13,
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "qa-expert",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a6ea5a81-8fb0-47ab-ba5b-5a1764d5bf89",
        "latencyMs": 44,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 14,
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [test-automator, qa-expert, backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "25bcad86-13c9-4fdb-a5e6-545d70a1dd3f",
        "latencyMs": 44,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help me set up automated testing for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "test-automator,qa-expert,backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Test automation framework setup",
          "vars": {
            "user_request": "help me set up automated testing for my application",
            "expected_agents": "code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 15,
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": "code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b8948c4c-bc5a-4470-91a6-881eee1fe2f6",
        "latencyMs": 42,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design RESTful API endpoints for user management\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,code-reviewer,microservices-architect",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API endpoint design",
          "vars": {
            "user_request": "design RESTful API endpoints for user management",
            "expected_agents": "api-designer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 16,
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": "api-designer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "8b1f7b3b-5b21-45f0-a940-01bd4b1c57a3",
        "latencyMs": 43,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design RESTful API endpoints for user management\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,code-reviewer,microservices-architect",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API endpoint design",
          "vars": {
            "user_request": "design RESTful API endpoints for user management",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 17,
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "8ec829d0-320c-4f1e-8213-386e90710f2d",
        "latencyMs": 45,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design RESTful API endpoints for user management\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,code-reviewer,microservices-architect",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API endpoint design",
          "vars": {
            "user_request": "design RESTful API endpoints for user management",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 18,
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [api-designer, backend-developer, documentation-engineer, code-reviewer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "504b49f0-bc1c-4763-b301-ffb8b1888b91",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design RESTful API endpoints for user management\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,code-reviewer,microservices-architect",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API endpoint design",
          "vars": {
            "user_request": "design RESTful API endpoints for user management",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 19,
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007992000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "eb65b740-5bd5-44b5-9296-ca97c7ce5df7",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Kubernetes manifests for my microservice\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,microservices-architect,backend-developer,development-orchestrator,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0007992000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment configuration",
          "vars": {
            "user_request": "create Kubernetes manifests for my microservice",
            "expected_agents": "kubernetes-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 20,
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": "kubernetes-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007992000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "07e8f136-e9bc-43bd-bb30-ffdddda66017",
        "latencyMs": 37,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Kubernetes manifests for my microservice\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,microservices-architect,backend-developer,development-orchestrator,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0007992000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment configuration",
          "vars": {
            "user_request": "create Kubernetes manifests for my microservice",
            "expected_agents": "microservices-architect",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 21,
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": "microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007992000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e7f0d799-858b-48d8-a302-e8eb882719d2",
        "latencyMs": 37,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Kubernetes manifests for my microservice\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,microservices-architect,backend-developer,development-orchestrator,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0007992000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment configuration",
          "vars": {
            "user_request": "create Kubernetes manifests for my microservice",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 22,
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007992000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, microservices-architect, backend-developer, development-orchestrator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "689679c3-4193-4390-8f2b-b9a10ee7b17d",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Kubernetes manifests for my microservice\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,microservices-architect,backend-developer,development-orchestrator,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0007992000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment configuration",
          "vars": {
            "user_request": "create Kubernetes manifests for my microservice",
            "expected_agents": "development-orchestrator",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 23,
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": "development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d56f7296-a88a-42ea-8134-9236cf4b53e8",
        "latencyMs": 46,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build a Django REST API with authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,api-designer,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Python Django application development",
          "vars": {
            "user_request": "build a Django REST API with authentication",
            "expected_agents": "django-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 24,
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": "django-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d4a0a110-d14d-4b5f-a2a2-0023a7bdd1a9",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build a Django REST API with authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,api-designer,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Python Django application development",
          "vars": {
            "user_request": "build a Django REST API with authentication",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 25,
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c43be90d-cfcf-4ad8-be20-f6930046b8bd",
        "latencyMs": 34,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build a Django REST API with authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,api-designer,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Python Django application development",
          "vars": {
            "user_request": "build a Django REST API with authentication",
            "expected_agents": "api-designer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 26,
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": "api-designer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [django-developer, backend-developer, api-designer, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "bf102869-a429-4028-96dc-55e83e565b00",
        "latencyMs": 39,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build a Django REST API with authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,api-designer,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Python Django application development",
          "vars": {
            "user_request": "build a Django REST API with authentication",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 27,
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: security-specialist"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2b67efae-a10a-460c-aa13-abf0f0b731ca",
        "latencyMs": 44,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: audit my application for security vulnerabilities\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,security-specialist,backend-developer,qa-expert,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Security vulnerability assessment",
          "vars": {
            "user_request": "audit my application for security vulnerabilities",
            "expected_agents": "qa-expert",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 28,
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": "qa-expert",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: security-specialist"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "5b2210ff-b915-435d-916b-2aad1104b610",
        "latencyMs": 45,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: audit my application for security vulnerabilities\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,security-specialist,backend-developer,qa-expert,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Security vulnerability assessment",
          "vars": {
            "user_request": "audit my application for security vulnerabilities",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 29,
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [security-specialist] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [security-specialist] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: security-specialist"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [security-specialist] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "05c130b8-0c37-4b19-956e-face12ab5594",
        "latencyMs": 42,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: audit my application for security vulnerabilities\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,security-specialist,backend-developer,qa-expert,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Security vulnerability assessment",
          "vars": {
            "user_request": "audit my application for security vulnerabilities",
            "expected_agents": "security-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 30,
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": "security-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Invalid agent names: security-specialist"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [code-reviewer, security-specialist, backend-developer, qa-expert, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "8eac295a-678f-4e3c-8237-20561dd12f47",
        "latencyMs": 43,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: audit my application for security vulnerabilities\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,security-specialist,backend-developer,qa-expert,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Security vulnerability assessment",
          "vars": {
            "user_request": "audit my application for security vulnerabilities",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 31,
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "882ee92d-dda6-4661-8813-811d5825cc66",
        "latencyMs": 43,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my API is slow, help me optimize performance\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect,debugger",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance optimization request",
          "vars": {
            "user_request": "my API is slow, help me optimize performance",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 32,
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e8ecd7ac-400c-4b28-a3c3-79c142255f48",
        "latencyMs": 46,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my API is slow, help me optimize performance\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect,debugger",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance optimization request",
          "vars": {
            "user_request": "my API is slow, help me optimize performance",
            "expected_agents": "aws-cloud-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 33,
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": "aws-cloud-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "326b2629-f735-4f23-886a-a6dc0f307893",
        "latencyMs": 48,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my API is slow, help me optimize performance\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect,debugger",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance optimization request",
          "vars": {
            "user_request": "my API is slow, help me optimize performance",
            "expected_agents": "datadog-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 34,
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": "datadog-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, aws-cloud-specialist, datadog-specialist, microservices-architect, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6f39cfd1-4d3b-40e1-bacc-17abd5e5de47",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my API is slow, help me optimize performance\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,aws-cloud-specialist,datadog-specialist,microservices-architect,debugger",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance optimization request",
          "vars": {
            "user_request": "my API is slow, help me optimize performance",
            "expected_agents": "microservices-architect",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 35,
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": "microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007864,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6aa650cc-48f4-46ef-8baa-2adb044102de",
        "latencyMs": 40,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: look up documentation for FastAPI async patterns\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer,python-pro,api-designer",
          "tokenUsage": {
            "cached": 895,
            "total": 895
          },
          "finishReason": "stop",
          "cost": 0.0007864
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation research request",
          "vars": {
            "user_request": "look up documentation for FastAPI async patterns",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 36,
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007864,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "249a8234-82c1-4c6f-8ea2-622274f7a57d",
        "latencyMs": 41,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: look up documentation for FastAPI async patterns\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer,python-pro,api-designer",
          "tokenUsage": {
            "cached": 895,
            "total": 895
          },
          "finishReason": "stop",
          "cost": 0.0007864
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation research request",
          "vars": {
            "user_request": "look up documentation for FastAPI async patterns",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 37,
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007864,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "46a207b8-08e5-45f0-b73b-4ede5479fc49",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: look up documentation for FastAPI async patterns\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer,python-pro,api-designer",
          "tokenUsage": {
            "cached": 895,
            "total": 895
          },
          "finishReason": "stop",
          "cost": 0.0007864
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation research request",
          "vars": {
            "user_request": "look up documentation for FastAPI async patterns",
            "expected_agents": "documentation-engineer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 38,
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": "documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007864,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [research-analyst, backend-developer, documentation-engineer, python-pro, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "dc16a483-3272-4567-94dd-f10d30203376",
        "latencyMs": 35,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: look up documentation for FastAPI async patterns\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer,python-pro,api-designer",
          "tokenUsage": {
            "cached": 895,
            "total": 895
          },
          "finishReason": "stop",
          "cost": 0.0007864
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation research request",
          "vars": {
            "user_request": "look up documentation for FastAPI async patterns",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "clear-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 39,
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007456,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [debugger] | Got: [debugger, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [debugger] | Got: [debugger, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [debugger] | Got: [debugger, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6a32ea0a-683e-4018-99ba-fbae71382eaf",
        "latencyMs": 35,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fix this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 880,
            "total": 880
          },
          "finishReason": "stop",
          "cost": 0.0007456
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Ambiguous fix request",
          "vars": {
            "user_request": "fix this",
            "expected_agents": "debugger",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 40,
        "vars": {
          "user_request": "fix this",
          "expected_agents": "debugger",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007456,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "91b921dc-0464-4aab-a5b8-3935700c05b8",
        "latencyMs": 34,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fix this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 880,
            "total": 880
          },
          "finishReason": "stop",
          "cost": 0.0007456
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Ambiguous fix request",
          "vars": {
            "user_request": "fix this",
            "expected_agents": "code-reviewer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 41,
        "vars": {
          "user_request": "fix this",
          "expected_agents": "code-reviewer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007456,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [debugger, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [debugger, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [debugger, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f967018c-ba16-45d1-ad67-64e57b583f41",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fix this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 880,
            "total": 880
          },
          "finishReason": "stop",
          "cost": 0.0007456
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Ambiguous fix request",
          "vars": {
            "user_request": "fix this",
            "expected_agents": "research-analyst",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 42,
        "vars": {
          "user_request": "fix this",
          "expected_agents": "research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007504,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c1303494-1cc1-41a4-a0e4-d8947660f9e8",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: make it better\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 882,
            "total": 882
          },
          "finishReason": "stop",
          "cost": 0.0007504
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Vague improvement request",
          "vars": {
            "user_request": "make it better",
            "expected_agents": "backend-developer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 43,
        "vars": {
          "user_request": "make it better",
          "expected_agents": "backend-developer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007504,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7580c35b-18aa-411e-acdf-b98ec34318c4",
        "latencyMs": 31,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: make it better\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 882,
            "total": 882
          },
          "finishReason": "stop",
          "cost": 0.0007504
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Vague improvement request",
          "vars": {
            "user_request": "make it better",
            "expected_agents": "code-reviewer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 44,
        "vars": {
          "user_request": "make it better",
          "expected_agents": "code-reviewer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007504,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [backend-developer, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [backend-developer, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [backend-developer, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "794c9e0b-bfa4-4a17-bf9b-7fc3469ac3b8",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: make it better\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 882,
            "total": 882
          },
          "finishReason": "stop",
          "cost": 0.0007504
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Vague improvement request",
          "vars": {
            "user_request": "make it better",
            "expected_agents": "documentation-engineer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 45,
        "vars": {
          "user_request": "make it better",
          "expected_agents": "documentation-engineer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007488,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a75a86e6-5267-4d56-9df5-dc5a76734a27",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 880,
            "total": 880
          },
          "finishReason": "stop",
          "cost": 0.0007488
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Generic help request",
          "vars": {
            "user_request": "help",
            "expected_agents": "research-analyst",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 46,
        "vars": {
          "user_request": "help",
          "expected_agents": "research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007488,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [research-analyst, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [research-analyst, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [research-analyst, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "370f0b46-713f-4c93-9fbc-541324bb182b",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 880,
            "total": 880
          },
          "finishReason": "stop",
          "cost": 0.0007488
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Generic help request",
          "vars": {
            "user_request": "help",
            "expected_agents": "backend-developer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 47,
        "vars": {
          "user_request": "help",
          "expected_agents": "backend-developer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007488,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [research-analyst, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [research-analyst, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [research-analyst, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1899a5b1-40b8-4059-bf39-adcc2149c0a1",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: help\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 880,
            "total": 880
          },
          "finishReason": "stop",
          "cost": 0.0007488
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Generic help request",
          "vars": {
            "user_request": "help",
            "expected_agents": "documentation-engineer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 48,
        "vars": {
          "user_request": "help",
          "expected_agents": "documentation-engineer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007464,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, debugger, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, debugger, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, debugger, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "bb3cfc49-c6d5-4dba-b814-538bb2dd1e38",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: check this code\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,debugger,python-pro",
          "tokenUsage": {
            "cached": 881,
            "total": 881
          },
          "finishReason": "stop",
          "cost": 0.0007464
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Vague check request",
          "vars": {
            "user_request": "check this code",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 49,
        "vars": {
          "user_request": "check this code",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007464,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [debugger] | Got: [code-reviewer, debugger, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [debugger] | Got: [code-reviewer, debugger, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [debugger] | Got: [code-reviewer, debugger, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "020928dc-d844-4917-a965-41ea0dffb51a",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: check this code\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,debugger,python-pro",
          "tokenUsage": {
            "cached": 881,
            "total": 881
          },
          "finishReason": "stop",
          "cost": 0.0007464
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Vague check request",
          "vars": {
            "user_request": "check this code",
            "expected_agents": "debugger",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 50,
        "vars": {
          "user_request": "check this code",
          "expected_agents": "debugger",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007464,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [python-pro] | Got: [code-reviewer, debugger, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [python-pro] | Got: [code-reviewer, debugger, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [python-pro] | Got: [code-reviewer, debugger, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "5d27828a-644d-4d0d-8949-8822f30c3dfc",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: check this code\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,debugger,python-pro",
          "tokenUsage": {
            "cached": 881,
            "total": 881
          },
          "finishReason": "stop",
          "cost": 0.0007464
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Vague check request",
          "vars": {
            "user_request": "check this code",
            "expected_agents": "python-pro",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 51,
        "vars": {
          "user_request": "check this code",
          "expected_agents": "python-pro",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007504,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, documentation-engineer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, documentation-engineer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "070f56e3-4398-45d3-8b48-dbfa9985b4ce",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review my work\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 882,
            "total": 882
          },
          "finishReason": "stop",
          "cost": 0.0007504
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Generic review request",
          "vars": {
            "user_request": "review my work",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 52,
        "vars": {
          "user_request": "review my work",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007504,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [code-reviewer, documentation-engineer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [code-reviewer, documentation-engineer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c171d5b0-27f8-44cc-92be-cf80eb38f9e4",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review my work\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 882,
            "total": 882
          },
          "finishReason": "stop",
          "cost": 0.0007504
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Generic review request",
          "vars": {
            "user_request": "review my work",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 53,
        "vars": {
          "user_request": "review my work",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007504,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [code-reviewer, documentation-engineer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [code-reviewer, documentation-engineer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "adbaad7c-21a5-4f23-a9bc-c07331fd7129",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review my work\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 882,
            "total": 882
          },
          "finishReason": "stop",
          "cost": 0.0007504
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Generic review request",
          "vars": {
            "user_request": "review my work",
            "expected_agents": "research-analyst",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 54,
        "vars": {
          "user_request": "review my work",
          "expected_agents": "research-analyst",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007336,
        "error": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, context-manager]",
        "gradingResult": {
          "pass": false,
          "score": 0.9166666666666666,
          "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, context-manager]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.6666666666666666,
              "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, context-manager]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "823248f3-0900-46ca-a678-ef08d264cbd9",
        "latencyMs": 17,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: analyze this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,context-manager",
          "tokenUsage": {
            "cached": 877,
            "total": 877
          },
          "finishReason": "stop",
          "cost": 0.0007336
        },
        "score": 0.9166666666666666,
        "success": false,
        "testCase": {
          "description": "Ambiguous analyze request",
          "vars": {
            "user_request": "analyze this",
            "expected_agents": "research-analyst",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 55,
        "vars": {
          "user_request": "analyze this",
          "expected_agents": "research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007336,
        "error": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [context-manager] | Got: [research-analyst, context-manager]",
        "gradingResult": {
          "pass": false,
          "score": 0.9166666666666666,
          "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [context-manager] | Got: [research-analyst, context-manager]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.6666666666666666,
              "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [context-manager] | Got: [research-analyst, context-manager]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "0efcfad1-6373-4f64-9a7e-c98fa073ae8a",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: analyze this\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,context-manager",
          "tokenUsage": {
            "cached": 877,
            "total": 877
          },
          "finishReason": "stop",
          "cost": 0.0007336
        },
        "score": 0.9166666666666666,
        "success": false,
        "testCase": {
          "description": "Ambiguous analyze request",
          "vars": {
            "user_request": "analyze this",
            "expected_agents": "context-manager",
            "priority": "NONE"
          },
          "metadata": {
            "category": "ambiguous-short",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 56,
        "vars": {
          "user_request": "analyze this",
          "expected_agents": "context-manager",
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "PROACTIVE agent research-analyst should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent research-analyst should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, test-automator, qa-expert]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent research-analyst should trigger but was not suggested"
            }
          ]
        },
        "id": "f70aa502-9ddb-41bb-a334-4cdd1a5c6775",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement user registration API with tests and documentation\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,test-automator,qa-expert",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Full stack implementation with testing",
          "vars": {
            "user_request": "implement user registration API with tests and documentation",
            "expected_agents": "backend-developer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 57,
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": "backend-developer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "PROACTIVE agent research-analyst should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent research-analyst should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [api-designer, backend-developer, documentation-engineer, test-automator, qa-expert]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent research-analyst should trigger but was not suggested"
            }
          ]
        },
        "id": "cdbc3ab2-8faa-4d3c-b8d7-018f601c7fba",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement user registration API with tests and documentation\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,test-automator,qa-expert",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Full stack implementation with testing",
          "vars": {
            "user_request": "implement user registration API with tests and documentation",
            "expected_agents": "test-automator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 58,
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": "test-automator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "PROACTIVE agent research-analyst should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent research-analyst should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, test-automator, qa-expert]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent research-analyst should trigger but was not suggested"
            }
          ]
        },
        "id": "ed3f8f1b-0f2b-4b5c-9330-22d583357520",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement user registration API with tests and documentation\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,test-automator,qa-expert",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Full stack implementation with testing",
          "vars": {
            "user_request": "implement user registration API with tests and documentation",
            "expected_agents": "documentation-engineer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 59,
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": "documentation-engineer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "PROACTIVE agent research-analyst should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent research-analyst should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, test-automator, qa-expert]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent research-analyst should trigger but was not suggested"
            }
          ]
        },
        "id": "a9496b9a-dbf6-42a9-9bf2-b62219ba7587",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement user registration API with tests and documentation\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,test-automator,qa-expert",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "Full stack implementation with testing",
          "vars": {
            "user_request": "implement user registration API with tests and documentation",
            "expected_agents": "api-designer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 60,
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": "api-designer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008080000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e961531d-ad53-4571-ad04-86e5a9f311a4",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design PostgreSQL schema for event sourced aggregates\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,eventsourcing-expert,microservices-architect,python-pro",
          "tokenUsage": {
            "cached": 902,
            "total": 902
          },
          "finishReason": "stop",
          "cost": 0.0008080000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Database schema with event sourcing",
          "vars": {
            "user_request": "design PostgreSQL schema for event sourced aggregates",
            "expected_agents": "postgres-pro",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 61,
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": "postgres-pro",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008080000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "fbc93a5b-0d17-4a5f-ab00-b80b018c4916",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design PostgreSQL schema for event sourced aggregates\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,eventsourcing-expert,microservices-architect,python-pro",
          "tokenUsage": {
            "cached": 902,
            "total": 902
          },
          "finishReason": "stop",
          "cost": 0.0008080000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Database schema with event sourcing",
          "vars": {
            "user_request": "design PostgreSQL schema for event sourced aggregates",
            "expected_agents": "eventsourcing-expert",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 62,
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": "eventsourcing-expert",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008080000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ba4cf87e-d73d-47dc-b401-e66cd365322f",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design PostgreSQL schema for event sourced aggregates\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,eventsourcing-expert,microservices-architect,python-pro",
          "tokenUsage": {
            "cached": 902,
            "total": 902
          },
          "finishReason": "stop",
          "cost": 0.0008080000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Database schema with event sourcing",
          "vars": {
            "user_request": "design PostgreSQL schema for event sourced aggregates",
            "expected_agents": "backend-developer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 63,
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": "backend-developer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008080000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [postgres-pro, backend-developer, eventsourcing-expert, microservices-architect, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "5c118e3d-54a2-4ec6-ae78-dfaa4c3b0f0f",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design PostgreSQL schema for event sourced aggregates\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,eventsourcing-expert,microservices-architect,python-pro",
          "tokenUsage": {
            "cached": 902,
            "total": 902
          },
          "finishReason": "stop",
          "cost": 0.0008080000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Database schema with event sourcing",
          "vars": {
            "user_request": "design PostgreSQL schema for event sourced aggregates",
            "expected_agents": "microservices-architect",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 64,
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": "microservices-architect",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "196b5aa8-cd02-4eb3-8028-8550035ebcba",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to Kubernetes with Datadog monitoring\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,datadog-specialist,backend-developer,development-orchestrator,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment with monitoring",
          "vars": {
            "user_request": "deploy to Kubernetes with Datadog monitoring",
            "expected_agents": "kubernetes-specialist",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 65,
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": "kubernetes-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1548c788-a3ab-45f5-82e8-5d009513633f",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to Kubernetes with Datadog monitoring\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,datadog-specialist,backend-developer,development-orchestrator,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment with monitoring",
          "vars": {
            "user_request": "deploy to Kubernetes with Datadog monitoring",
            "expected_agents": "datadog-specialist",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 66,
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": "datadog-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "40d1639e-64b6-49b4-80e3-5761089dcac3",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to Kubernetes with Datadog monitoring\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,datadog-specialist,backend-developer,development-orchestrator,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment with monitoring",
          "vars": {
            "user_request": "deploy to Kubernetes with Datadog monitoring",
            "expected_agents": "backend-developer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 67,
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": "backend-developer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008032000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, datadog-specialist, backend-developer, development-orchestrator, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1469e9ab-15ef-4657-b71d-7cce44fc9b17",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to Kubernetes with Datadog monitoring\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,datadog-specialist,backend-developer,development-orchestrator,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008032000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Kubernetes deployment with monitoring",
          "vars": {
            "user_request": "deploy to Kubernetes with Datadog monitoring",
            "expected_agents": "development-orchestrator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 68,
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": "development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "4fa0fc15-15b5-4613-9aa3-622d1b011f6d",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API with security audit and tests\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,code-reviewer,test-automator,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API development with security testing",
          "vars": {
            "user_request": "build REST API with security audit and tests",
            "expected_agents": "api-designer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 69,
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": "api-designer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "33c91300-8fc7-486b-b026-12119e2090a4",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API with security audit and tests\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,code-reviewer,test-automator,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API development with security testing",
          "vars": {
            "user_request": "build REST API with security audit and tests",
            "expected_agents": "test-automator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 70,
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": "test-automator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "67e99978-d3e2-4dfe-9816-61c06be1acdb",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API with security audit and tests\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,code-reviewer,test-automator,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API development with security testing",
          "vars": {
            "user_request": "build REST API with security audit and tests",
            "expected_agents": "backend-developer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 71,
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": "backend-developer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007904,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [api-designer, backend-developer, code-reviewer, test-automator, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "062088ef-fd72-41f2-9ad0-7d7adc5cb083",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API with security audit and tests\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,code-reviewer,test-automator,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007904
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API development with security testing",
          "vars": {
            "user_request": "build REST API with security audit and tests",
            "expected_agents": "code-reviewer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "multi-domain",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 72,
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": "code-reviewer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007880000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f327b0ba-cd54-47d9-b0ae-bd0921c48a53",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: how does Django's ORM handle database transactions?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007880000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "How does framework work",
          "vars": {
            "user_request": "how does Django's ORM handle database transactions?",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 73,
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007880000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a308ae56-e44b-47c9-9af0-b746a9ae386e",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: how does Django's ORM handle database transactions?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007880000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "How does framework work",
          "vars": {
            "user_request": "how does Django's ORM handle database transactions?",
            "expected_agents": "django-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 74,
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": "django-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007880000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "51c7acc4-6ee4-4b93-8a3d-021c3feca1cd",
        "latencyMs": 36,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: how does Django's ORM handle database transactions?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007880000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "How does framework work",
          "vars": {
            "user_request": "how does Django's ORM handle database transactions?",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 75,
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007880000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [django-developer, backend-developer, python-pro, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "db919fe6-9837-4fb2-8ee6-1fa9fbd87506",
        "latencyMs": 30,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: how does Django's ORM handle database transactions?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007880000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "How does framework work",
          "vars": {
            "user_request": "how does Django's ORM handle database transactions?",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 76,
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007568,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f8e728c6-6d98-4ac4-9ae4-2bb15fd43fed",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what are best practices for PostgreSQL connection pooling?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007568
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Best practices inquiry",
          "vars": {
            "user_request": "what are best practices for PostgreSQL connection pooling?",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 77,
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007568,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2c6c3bb0-4c59-4997-8389-0710ffeb2260",
        "latencyMs": 33,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what are best practices for PostgreSQL connection pooling?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007568
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Best practices inquiry",
          "vars": {
            "user_request": "what are best practices for PostgreSQL connection pooling?",
            "expected_agents": "postgres-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 78,
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?",
          "expected_agents": "postgres-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007568,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ca2105ec-3656-4d8a-b1f2-05480606a5f5",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what are best practices for PostgreSQL connection pooling?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007568
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Best practices inquiry",
          "vars": {
            "user_request": "what are best practices for PostgreSQL connection pooling?",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 79,
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007760000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7335644f-f6b0-495c-8205-b774038e5218",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fetch documentation for OpenTelemetry Python SDK\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,python-pro",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007760000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Documentation lookup",
          "vars": {
            "user_request": "fetch documentation for OpenTelemetry Python SDK",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 80,
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007760000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c10955f4-659e-4598-a9cc-8dcc36146e1b",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fetch documentation for OpenTelemetry Python SDK\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,python-pro",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007760000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Documentation lookup",
          "vars": {
            "user_request": "fetch documentation for OpenTelemetry Python SDK",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 81,
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007760000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "9961af90-6d25-4ff2-8c29-dc4a54f576b1",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fetch documentation for OpenTelemetry Python SDK\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,python-pro",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007760000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Documentation lookup",
          "vars": {
            "user_request": "fetch documentation for OpenTelemetry Python SDK",
            "expected_agents": "documentation-engineer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 82,
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": "documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007760000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, research-analyst, documentation-engineer, python-pro]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "096e4db5-a43b-45ca-b65c-66ff281ea778",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: fetch documentation for OpenTelemetry Python SDK\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,python-pro",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007760000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Documentation lookup",
          "vars": {
            "user_request": "fetch documentation for OpenTelemetry Python SDK",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 83,
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007888,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2f978977-618f-45d2-a557-f3cfab14fba7",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: research ddtrace library features\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,python-pro,documentation-engineer,backend-developer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007888
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Library research",
          "vars": {
            "user_request": "research ddtrace library features",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 84,
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007888,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ec7f4f5e-0bb8-450d-aa94-265ec24599eb",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: research ddtrace library features\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,python-pro,documentation-engineer,backend-developer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007888
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Library research",
          "vars": {
            "user_request": "research ddtrace library features",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 85,
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007888,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "93514898-edac-4f7c-9ed1-124777b0ecc2",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: research ddtrace library features\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,python-pro,documentation-engineer,backend-developer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007888
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Library research",
          "vars": {
            "user_request": "research ddtrace library features",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 86,
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007888,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, python-pro, documentation-engineer, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c25f70c5-510c-4aa7-bb94-687df76db711",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: research ddtrace library features\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,python-pro,documentation-engineer,backend-developer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007888
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Library research",
          "vars": {
            "user_request": "research ddtrace library features",
            "expected_agents": "documentation-engineer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 87,
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": "documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "053b65fc-6e24-492e-83cc-6c8be3edd370",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: find API reference for Datadog metrics submission\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,backend-developer,api-designer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API reference lookup",
          "vars": {
            "user_request": "find API reference for Datadog metrics submission",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 88,
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ece4d303-65f7-4c8a-9c89-69b1dd25f259",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: find API reference for Datadog metrics submission\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,backend-developer,api-designer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API reference lookup",
          "vars": {
            "user_request": "find API reference for Datadog metrics submission",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 89,
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ba49bebf-ba3b-464d-ba83-1d751c30d39e",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: find API reference for Datadog metrics submission\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,backend-developer,api-designer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API reference lookup",
          "vars": {
            "user_request": "find API reference for Datadog metrics submission",
            "expected_agents": "documentation-engineer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 90,
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": "documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, research-analyst, documentation-engineer, backend-developer, api-designer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b57647e5-1da9-4b3e-b0d6-9c3c1358a305",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: find API reference for Datadog metrics submission\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,research-analyst,documentation-engineer,backend-developer,api-designer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007912
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "API reference lookup",
          "vars": {
            "user_request": "find API reference for Datadog metrics submission",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "proactive-research",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 91,
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "98864eaf-f74b-46f4-ba70-8361024a2af5",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement observability for my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist,documentation-engineer",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - observability",
          "vars": {
            "user_request": "implement observability for my microservices",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 92,
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1b658c66-8f9c-428b-8abb-6a27f1872f10",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement observability for my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist,documentation-engineer",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - observability",
          "vars": {
            "user_request": "implement observability for my microservices",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 93,
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "06647935-f757-48c4-99fd-aabc1062fe95",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement observability for my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist,documentation-engineer",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - observability",
          "vars": {
            "user_request": "implement observability for my microservices",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 94,
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, microservices-architect, backend-developer, aws-cloud-specialist, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ea05d738-ed4d-400d-9db7-7c8406c99e23",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement observability for my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,microservices-architect,backend-developer,aws-cloud-specialist,documentation-engineer",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - observability",
          "vars": {
            "user_request": "implement observability for my microservices",
            "expected_agents": "aws-cloud-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 95,
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": "aws-cloud-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "11d8437b-a636-4ba5-9575-f25f66616b4f",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: add instrumentation to track request latency\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - instrumentation",
          "vars": {
            "user_request": "add instrumentation to track request latency",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 96,
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c69a791e-ad9a-4b3f-aff3-80af85311885",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: add instrumentation to track request latency\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - instrumentation",
          "vars": {
            "user_request": "add instrumentation to track request latency",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 97,
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ec277b86-4332-46c6-8d8f-6d5f749199d0",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: add instrumentation to track request latency\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - instrumentation",
          "vars": {
            "user_request": "add instrumentation to track request latency",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 98,
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [datadog-specialist, backend-developer, microservices-architect, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "fa656c33-cb21-401b-a289-b7e512d264fd",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: add instrumentation to track request latency\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for monitoring - instrumentation",
          "vars": {
            "user_request": "add instrumentation to track request latency",
            "expected_agents": "code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 99,
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": "code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007920000000000002,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "73cebfc9-4af6-4bdd-8540-ecad24420564",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: run quality assurance checks\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "qa-expert,test-automator,code-reviewer,development-orchestrator,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007920000000000002
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for testing - QA",
          "vars": {
            "user_request": "run quality assurance checks",
            "expected_agents": "test-automator",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 100,
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": "test-automator",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007920000000000002,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [qa-expert] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ee9acf71-d9c1-48be-9689-252ad19bb7ce",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: run quality assurance checks\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "qa-expert,test-automator,code-reviewer,development-orchestrator,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007920000000000002
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for testing - QA",
          "vars": {
            "user_request": "run quality assurance checks",
            "expected_agents": "qa-expert",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 101,
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": "qa-expert",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007920000000000002,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "70bc1323-aa0a-4b11-bde0-11b1fc88d207",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: run quality assurance checks\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "qa-expert,test-automator,code-reviewer,development-orchestrator,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007920000000000002
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for testing - QA",
          "vars": {
            "user_request": "run quality assurance checks",
            "expected_agents": "code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 102,
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": "code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007920000000000002,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [qa-expert, test-automator, code-reviewer, development-orchestrator, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "390ec93f-5b94-40b6-a53b-7697a22b953a",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: run quality assurance checks\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "qa-expert,test-automator,code-reviewer,development-orchestrator,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007920000000000002
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Synonym for testing - QA",
          "vars": {
            "user_request": "run quality assurance checks",
            "expected_agents": "development-orchestrator",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-synonym",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 103,
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": "development-orchestrator",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e11530e5-4a1f-41fd-b25a-ac4f3041b27b",
        "latencyMs": 28,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my database queries are taking too long\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,debugger,datadog-specialist,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - query performance",
          "vars": {
            "user_request": "my database queries are taking too long",
            "expected_agents": "postgres-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 104,
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": "postgres-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "916bafb1-7c34-42c0-b132-87e060a35b26",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my database queries are taking too long\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,debugger,datadog-specialist,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - query performance",
          "vars": {
            "user_request": "my database queries are taking too long",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 105,
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "32a08926-a717-47d4-b6fc-4288dcee594c",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my database queries are taking too long\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,debugger,datadog-specialist,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - query performance",
          "vars": {
            "user_request": "my database queries are taking too long",
            "expected_agents": "debugger",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 106,
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": "debugger",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, postgres-pro, debugger, datadog-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f55c3df3-ff0f-4e50-94dc-81e65de0e397",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my database queries are taking too long\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,debugger,datadog-specialist,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - query performance",
          "vars": {
            "user_request": "my database queries are taking too long",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 107,
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7e8c0e7b-22ac-462c-ac75-7c7956edd508",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: trace requests across my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "microservices-architect,datadog-specialist,backend-developer,debugger,research-analyst",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - distributed tracing",
          "vars": {
            "user_request": "trace requests across my microservices",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 108,
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b0e214d1-a118-4079-b60a-dff462769792",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: trace requests across my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "microservices-architect,datadog-specialist,backend-developer,debugger,research-analyst",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - distributed tracing",
          "vars": {
            "user_request": "trace requests across my microservices",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 109,
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "68d68ac5-0d94-4cd7-a281-0bc0c0610daf",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: trace requests across my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "microservices-architect,datadog-specialist,backend-developer,debugger,research-analyst",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - distributed tracing",
          "vars": {
            "user_request": "trace requests across my microservices",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 110,
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [microservices-architect, datadog-specialist, backend-developer, debugger, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1ebec100-7892-48d6-9500-0da0a045a4ca",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: trace requests across my microservices\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "microservices-architect,datadog-specialist,backend-developer,debugger,research-analyst",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - distributed tracing",
          "vars": {
            "user_request": "trace requests across my microservices",
            "expected_agents": "debugger",
            "priority": "MUST"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 111,
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": "debugger",
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "091c7dcc-edd1-4cd0-9d86-f2640c7c90b9",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: manage my containerized applications at scale\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator,backend-developer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - container orchestration",
          "vars": {
            "user_request": "manage my containerized applications at scale",
            "expected_agents": "kubernetes-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 112,
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": "kubernetes-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "3f40d0ef-330e-4c4b-8b1f-d4f274a88656",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: manage my containerized applications at scale\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator,backend-developer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - container orchestration",
          "vars": {
            "user_request": "manage my containerized applications at scale",
            "expected_agents": "aws-cloud-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 113,
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": "aws-cloud-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d0b3e265-4e21-46f0-bfda-647b80979725",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: manage my containerized applications at scale\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator,backend-developer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - container orchestration",
          "vars": {
            "user_request": "manage my containerized applications at scale",
            "expected_agents": "microservices-architect",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 114,
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": "microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, aws-cloud-specialist, microservices-architect, development-orchestrator, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "343bde64-c532-4f84-b5d7-004799610c2e",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: manage my containerized applications at scale\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,microservices-architect,development-orchestrator,backend-developer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Indirect reference - container orchestration",
          "vars": {
            "user_request": "manage my containerized applications at scale",
            "expected_agents": "development-orchestrator",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "edge-case-indirect",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 115,
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": "development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007792000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "31447c47-a0f4-4777-b453-092ccc6574f5",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize postgres database indexes\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst,code-reviewer,debugger",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007792000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - postgres vs postgresql",
          "vars": {
            "user_request": "optimize postgres database indexes",
            "expected_agents": "postgres-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 116,
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": "postgres-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007792000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "73790e7f-91ca-49c0-9d51-0193770c2ea4",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize postgres database indexes\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst,code-reviewer,debugger",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007792000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - postgres vs postgresql",
          "vars": {
            "user_request": "optimize postgres database indexes",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 117,
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007792000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "dbbe9ae0-5d50-4e35-b886-2e46d11dfcc2",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize postgres database indexes\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst,code-reviewer,debugger",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007792000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - postgres vs postgresql",
          "vars": {
            "user_request": "optimize postgres database indexes",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 118,
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007792000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [postgres-pro, backend-developer, research-analyst, code-reviewer, debugger]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "03cc5a6d-3bea-4226-bb55-709719c63d6b",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: optimize postgres database indexes\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "postgres-pro,backend-developer,research-analyst,code-reviewer,debugger",
          "tokenUsage": {
            "cached": 890,
            "total": 890
          },
          "finishReason": "stop",
          "cost": 0.0007792000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - postgres vs postgresql",
          "vars": {
            "user_request": "optimize postgres database indexes",
            "expected_agents": "code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 119,
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": "code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007968000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [kubernetes-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "0b6686c1-cacd-4fca-bb9b-dd99dbd80eba",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to k8s cluster\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007968000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - k8s abbreviation",
          "vars": {
            "user_request": "deploy to k8s cluster",
            "expected_agents": "kubernetes-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 120,
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": "kubernetes-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007968000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "79eb04e8-0ada-473f-afa9-2c27fa343b85",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to k8s cluster\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007968000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - k8s abbreviation",
          "vars": {
            "user_request": "deploy to k8s cluster",
            "expected_agents": "aws-cloud-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 121,
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": "aws-cloud-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007968000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e7c20d65-f278-4fbd-aad6-5d4f15e5f202",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to k8s cluster\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007968000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - k8s abbreviation",
          "vars": {
            "user_request": "deploy to k8s cluster",
            "expected_agents": "development-orchestrator",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 122,
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": "development-orchestrator",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007968000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [kubernetes-specialist, aws-cloud-specialist, development-orchestrator, backend-developer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "648aed68-95c7-4bae-a403-4509c985a1fb",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: deploy to k8s cluster\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "kubernetes-specialist,aws-cloud-specialist,development-orchestrator,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007968000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Typo - k8s abbreviation",
          "vars": {
            "user_request": "deploy to k8s cluster",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "typo",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 123,
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e2e47114-4cfc-4b12-9f81-98152a6b7ca4",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007912000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Common abbreviation - API",
          "vars": {
            "user_request": "build REST API endpoints",
            "expected_agents": "api-designer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "abbreviation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 124,
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": "api-designer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b6280d40-7775-4446-a783-abe321b8ee9c",
        "latencyMs": 17,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007912000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Common abbreviation - API",
          "vars": {
            "user_request": "build REST API endpoints",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "abbreviation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 125,
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "48c026c6-576d-4ce7-869e-52cf02140663",
        "latencyMs": 17,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007912000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Common abbreviation - API",
          "vars": {
            "user_request": "build REST API endpoints",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "abbreviation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 126,
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007912000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [api-designer, backend-developer, documentation-engineer, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7081f58f-8150-4888-8dee-f9c23733ce7c",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build REST API endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,documentation-engineer,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007912000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Common abbreviation - API",
          "vars": {
            "user_request": "build REST API endpoints",
            "expected_agents": "microservices-architect",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "abbreviation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 127,
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": "microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "ea188b90-64f6-457b-8c5a-5e994c6cc7de",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: debug production error using Datadog traces\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,debugger,backend-developer,aws-cloud-specialist,research-analyst",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Debug production issue with monitoring",
          "vars": {
            "user_request": "debug production error using Datadog traces",
            "expected_agents": "debugger",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 128,
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": "debugger",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "78e9e3e0-feee-4e1c-9081-5ed6e2a74392",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: debug production error using Datadog traces\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,debugger,backend-developer,aws-cloud-specialist,research-analyst",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Debug production issue with monitoring",
          "vars": {
            "user_request": "debug production error using Datadog traces",
            "expected_agents": "datadog-specialist",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 129,
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": "datadog-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f32fe32c-aac5-47f4-a1de-d865b798465e",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: debug production error using Datadog traces\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,debugger,backend-developer,aws-cloud-specialist,research-analyst",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Debug production issue with monitoring",
          "vars": {
            "user_request": "debug production error using Datadog traces",
            "expected_agents": "backend-developer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 130,
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": "backend-developer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, debugger, backend-developer, aws-cloud-specialist, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "936c57d6-1b8f-432a-b8f4-858c61040e5d",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: debug production error using Datadog traces\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,debugger,backend-developer,aws-cloud-specialist,research-analyst",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Debug production issue with monitoring",
          "vars": {
            "user_request": "debug production error using Datadog traces",
            "expected_agents": "aws-cloud-specialist",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 131,
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": "aws-cloud-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [postgres-pro] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6e44a236-4bf3-4990-b3f0-d1bb37f6ee59",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: migrate database schema and ensure tests pass\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,test-automator,development-orchestrator,code-reviewer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Migration with testing",
          "vars": {
            "user_request": "migrate database schema and ensure tests pass",
            "expected_agents": "postgres-pro",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 132,
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": "postgres-pro",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [test-automator] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "fadc65c6-0722-401d-991c-fc070b78e7d5",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: migrate database schema and ensure tests pass\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,test-automator,development-orchestrator,code-reviewer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Migration with testing",
          "vars": {
            "user_request": "migrate database schema and ensure tests pass",
            "expected_agents": "test-automator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 133,
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": "test-automator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "52dd9e12-926d-4f4f-9d58-bbdcdc4f5f36",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: migrate database schema and ensure tests pass\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,test-automator,development-orchestrator,code-reviewer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Migration with testing",
          "vars": {
            "user_request": "migrate database schema and ensure tests pass",
            "expected_agents": "backend-developer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 134,
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": "backend-developer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007936,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [backend-developer, postgres-pro, test-automator, development-orchestrator, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2f32a8b5-411c-467f-8a4f-80456a70e906",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: migrate database schema and ensure tests pass\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,postgres-pro,test-automator,development-orchestrator,code-reviewer",
          "tokenUsage": {
            "cached": 896,
            "total": 896
          },
          "finishReason": "stop",
          "cost": 0.0007936
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Migration with testing",
          "vars": {
            "user_request": "migrate database schema and ensure tests pass",
            "expected_agents": "development-orchestrator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 135,
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": "development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008104000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "967f56ba-f006-4eeb-b238-2b1fdcc01313",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up AWS infrastructure with monitoring and logging\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "aws-cloud-specialist,datadog-specialist,development-orchestrator,documentation-engineer,microservices-architect",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0008104000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Cloud infrastructure setup",
          "vars": {
            "user_request": "set up AWS infrastructure with monitoring and logging",
            "expected_agents": "aws-cloud-specialist",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 136,
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": "aws-cloud-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008104000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "de5e1931-41e6-4625-918d-c123fa13d0ee",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up AWS infrastructure with monitoring and logging\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "aws-cloud-specialist,datadog-specialist,development-orchestrator,documentation-engineer,microservices-architect",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0008104000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Cloud infrastructure setup",
          "vars": {
            "user_request": "set up AWS infrastructure with monitoring and logging",
            "expected_agents": "datadog-specialist",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 137,
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": "datadog-specialist",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008104000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [development-orchestrator] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "1fc67b9a-e9e4-49af-a01a-724689598288",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up AWS infrastructure with monitoring and logging\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "aws-cloud-specialist,datadog-specialist,development-orchestrator,documentation-engineer,microservices-architect",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0008104000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Cloud infrastructure setup",
          "vars": {
            "user_request": "set up AWS infrastructure with monitoring and logging",
            "expected_agents": "development-orchestrator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 138,
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": "development-orchestrator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008104000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [aws-cloud-specialist, datadog-specialist, development-orchestrator, documentation-engineer, microservices-architect]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c90e7bf0-14f0-490a-b925-11236ee6ddd4",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: set up AWS infrastructure with monitoring and logging\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "aws-cloud-specialist,datadog-specialist,development-orchestrator,documentation-engineer,microservices-architect",
          "tokenUsage": {
            "cached": 901,
            "total": 901
          },
          "finishReason": "stop",
          "cost": 0.0008104000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Cloud infrastructure setup",
          "vars": {
            "user_request": "set up AWS infrastructure with monitoring and logging",
            "expected_agents": "documentation-engineer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "complex-scenario",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 139,
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": "documentation-engineer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [django-developer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e7885268-5c5b-483a-a44d-093adc0d6cb7",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Django models for user authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Django-specific request",
          "vars": {
            "user_request": "create Django models for user authentication",
            "expected_agents": "django-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 140,
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": "django-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "272dae4a-9345-42ec-b170-2c4e2a31f333",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Django models for user authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Django-specific request",
          "vars": {
            "user_request": "create Django models for user authentication",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 141,
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "14202bb8-c570-43fd-92e4-9b1477840bd7",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Django models for user authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Django-specific request",
          "vars": {
            "user_request": "create Django models for user authentication",
            "expected_agents": "python-pro",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 142,
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": "python-pro",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [django-developer, backend-developer, python-pro, code-reviewer, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "bcda986e-a5b7-4fd1-9e91-03dc0167f9a8",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: create Django models for user authentication\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "django-developer,backend-developer,python-pro,code-reviewer,documentation-engineer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Django-specific request",
          "vars": {
            "user_request": "create Django models for user authentication",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 143,
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2a6577ac-fdeb-4c2d-bfdf-dc7b9f8eafc6",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build FastAPI application with async endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,python-pro,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "FastAPI development",
          "vars": {
            "user_request": "build FastAPI application with async endpoints",
            "expected_agents": "python-pro",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 144,
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": "python-pro",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "85f436bc-ae9f-4893-aa1f-122a60ebff63",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build FastAPI application with async endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,python-pro,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "FastAPI development",
          "vars": {
            "user_request": "build FastAPI application with async endpoints",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 145,
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "11d9f564-8f23-4429-b22b-e0044605978c",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build FastAPI application with async endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,python-pro,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "FastAPI development",
          "vars": {
            "user_request": "build FastAPI application with async endpoints",
            "expected_agents": "api-designer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 146,
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": "api-designer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007856,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, backend-developer, python-pro, documentation-engineer, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d2511a68-4a64-4d25-be27-257934a421de",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: build FastAPI application with async endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,backend-developer,python-pro,documentation-engineer,code-reviewer",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007856
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "FastAPI development",
          "vars": {
            "user_request": "build FastAPI application with async endpoints",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "framework-specific",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 147,
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007824,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "fdaaca92-49d2-4977-838d-cd898c292f00",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my application crashes on startup, help debug\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,backend-developer,python-pro,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007824
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Error debugging",
          "vars": {
            "user_request": "my application crashes on startup, help debug",
            "expected_agents": "debugger",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 148,
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": "debugger",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007824,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d6d095c1-a82b-4b88-97cf-35edd62a0636",
        "latencyMs": 18,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my application crashes on startup, help debug\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,backend-developer,python-pro,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007824
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Error debugging",
          "vars": {
            "user_request": "my application crashes on startup, help debug",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 149,
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007824,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "fd6e1b59-c4b0-4e53-8538-6f203328dc42",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my application crashes on startup, help debug\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,backend-developer,python-pro,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007824
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Error debugging",
          "vars": {
            "user_request": "my application crashes on startup, help debug",
            "expected_agents": "python-pro",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 150,
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": "python-pro",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007824,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, backend-developer, python-pro, code-reviewer, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2c47e748-d070-4d11-a19e-71e8f87d3a44",
        "latencyMs": 18,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: my application crashes on startup, help debug\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,backend-developer,python-pro,code-reviewer,research-analyst",
          "tokenUsage": {
            "cached": 894,
            "total": 894
          },
          "finishReason": "stop",
          "cost": 0.0007824
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Error debugging",
          "vars": {
            "user_request": "my application crashes on startup, help debug",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 151,
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007704000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [debugger] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [debugger] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [debugger] | Got: [debugger, test-automator, code-reviewer, qa-expert]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "88e81fd2-787c-4ab1-b3b0-10b050dbc25f",
        "latencyMs": 18,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tests are failing, help me fix them\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,test-automator,code-reviewer,qa-expert",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007704000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Test failure debugging",
          "vars": {
            "user_request": "tests are failing, help me fix them",
            "expected_agents": "debugger",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 152,
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": "debugger",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007704000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [test-automator] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [test-automator] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [test-automator] | Got: [debugger, test-automator, code-reviewer, qa-expert]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "90fde56a-0fad-48c3-a03f-37e75fd32bb0",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tests are failing, help me fix them\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,test-automator,code-reviewer,qa-expert",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007704000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Test failure debugging",
          "vars": {
            "user_request": "tests are failing, help me fix them",
            "expected_agents": "test-automator",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 153,
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": "test-automator",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007704000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [code-reviewer] | Got: [debugger, test-automator, code-reviewer, qa-expert]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "68499fe8-f70f-4a15-9303-7bceef524b37",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tests are failing, help me fix them\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,test-automator,code-reviewer,qa-expert",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007704000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Test failure debugging",
          "vars": {
            "user_request": "tests are failing, help me fix them",
            "expected_agents": "code-reviewer",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 154,
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": "code-reviewer",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007704000000000001,
        "error": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [qa-expert] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
        "gradingResult": {
          "pass": false,
          "score": 0.85,
          "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [qa-expert] | Got: [debugger, test-automator, code-reviewer, qa-expert]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.4,
              "reason": "F1: 0.40, Precision: 0.25, Recall: 1.00 | Expected: [qa-expert] | Got: [debugger, test-automator, code-reviewer, qa-expert]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a4890ea2-9947-4d8a-8b08-3de257a66c48",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tests are failing, help me fix them\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "debugger,test-automator,code-reviewer,qa-expert",
          "tokenUsage": {
            "cached": 891,
            "total": 891
          },
          "finishReason": "stop",
          "cost": 0.0007704000000000001
        },
        "score": 0.85,
        "success": false,
        "testCase": {
          "description": "Test failure debugging",
          "vars": {
            "user_request": "tests are failing, help me fix them",
            "expected_agents": "qa-expert",
            "priority": "MULTIPLE"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 155,
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": "qa-expert",
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "345feb2c-60df-45be-b223-c2a0b161003f",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: identify performance bottleneck in my API\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,datadog-specialist,debugger,microservices-architect,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance bottleneck",
          "vars": {
            "user_request": "identify performance bottleneck in my API",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 156,
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f46df5a3-b34c-4620-ad50-012883984d73",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: identify performance bottleneck in my API\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,datadog-specialist,debugger,microservices-architect,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance bottleneck",
          "vars": {
            "user_request": "identify performance bottleneck in my API",
            "expected_agents": "datadog-specialist",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 157,
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": "datadog-specialist",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [debugger] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d00bff61-9e10-4215-ae45-edd9ec3d11cb",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: identify performance bottleneck in my API\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,datadog-specialist,debugger,microservices-architect,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance bottleneck",
          "vars": {
            "user_request": "identify performance bottleneck in my API",
            "expected_agents": "debugger",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 158,
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": "debugger",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007944,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, datadog-specialist, debugger, microservices-architect, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "83a60ddc-5f45-4672-ab0d-f1491b4b4bd7",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: identify performance bottleneck in my API\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,datadog-specialist,debugger,microservices-architect,code-reviewer",
          "tokenUsage": {
            "cached": 897,
            "total": 897
          },
          "finishReason": "stop",
          "cost": 0.0007944
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Performance bottleneck",
          "vars": {
            "user_request": "identify performance bottleneck in my API",
            "expected_agents": "microservices-architect",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "debugging",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 159,
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": "microservices-architect",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007528,
        "error": "PROACTIVE agent test-automator should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.625,
          "reason": "PROACTIVE agent test-automator should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [code-reviewer] | Got: [code-reviewer, backend-developer, documentation-engineer]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent test-automator should trigger but was not suggested"
            }
          ]
        },
        "id": "a4b5ac5c-a754-4fff-9f84-db6dd2fbcdb0",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review this pull request for quality\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 885,
            "total": 885
          },
          "finishReason": "stop",
          "cost": 0.0007528
        },
        "score": 0.625,
        "success": false,
        "testCase": {
          "description": "Code review request",
          "vars": {
            "user_request": "review this pull request for quality",
            "expected_agents": "code-reviewer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "code-review",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 160,
        "vars": {
          "user_request": "review this pull request for quality",
          "expected_agents": "code-reviewer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007528,
        "error": "PROACTIVE agent test-automator should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.625,
          "reason": "PROACTIVE agent test-automator should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [code-reviewer, backend-developer, documentation-engineer]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent test-automator should trigger but was not suggested"
            }
          ]
        },
        "id": "0f6bfea3-18ee-4b20-aba3-cb6bcece9052",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review this pull request for quality\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 885,
            "total": 885
          },
          "finishReason": "stop",
          "cost": 0.0007528
        },
        "score": 0.625,
        "success": false,
        "testCase": {
          "description": "Code review request",
          "vars": {
            "user_request": "review this pull request for quality",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "code-review",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 161,
        "vars": {
          "user_request": "review this pull request for quality",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007528,
        "error": "PROACTIVE agent test-automator should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.625,
          "reason": "PROACTIVE agent test-automator should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [documentation-engineer] | Got: [code-reviewer, backend-developer, documentation-engineer]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent test-automator should trigger but was not suggested"
            }
          ]
        },
        "id": "9029c467-e0f9-4c87-a24a-1cab384a17d2",
        "latencyMs": 25,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: review this pull request for quality\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "code-reviewer,backend-developer,documentation-engineer",
          "tokenUsage": {
            "cached": 885,
            "total": 885
          },
          "finishReason": "stop",
          "cost": 0.0007528
        },
        "score": 0.625,
        "success": false,
        "testCase": {
          "description": "Code review request",
          "vars": {
            "user_request": "review this pull request for quality",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "code-review",
            "expected_strategy": "llm"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 162,
        "vars": {
          "user_request": "review this pull request for quality",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "456e9e0c-04d6-4557-a09c-9a3e6aa666e6",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: write API documentation for these endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,documentation-engineer,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation writing",
          "vars": {
            "user_request": "write API documentation for these endpoints",
            "expected_agents": "documentation-engineer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "documentation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 163,
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": "documentation-engineer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [api-designer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7196683a-59f8-469a-b9c5-8d106aba1c66",
        "latencyMs": 32,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: write API documentation for these endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,documentation-engineer,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation writing",
          "vars": {
            "user_request": "write API documentation for these endpoints",
            "expected_agents": "api-designer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "documentation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 164,
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": "api-designer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "609330c3-11ec-49dc-b7ed-4b786c6d789b",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: write API documentation for these endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,documentation-engineer,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation writing",
          "vars": {
            "user_request": "write API documentation for these endpoints",
            "expected_agents": "backend-developer",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "documentation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 165,
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": "backend-developer",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007848,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [api-designer, documentation-engineer, backend-developer, research-analyst, code-reviewer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "600f1437-d56e-441d-a7a1-5d65e2be02ed",
        "latencyMs": 30,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: write API documentation for these endpoints\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "api-designer,documentation-engineer,backend-developer,research-analyst,code-reviewer",
          "tokenUsage": {
            "cached": 893,
            "total": 893
          },
          "finishReason": "stop",
          "cost": 0.0007848
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Documentation writing",
          "vars": {
            "user_request": "write API documentation for these endpoints",
            "expected_agents": "research-analyst",
            "priority": "SHOULD"
          },
          "metadata": {
            "category": "documentation",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 166,
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": "research-analyst",
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007656000000000001,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "5bedf3e4-90f9-4c9a-8bab-83bfba75086f",
        "latencyMs": 30,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: send custom metrics to Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 889,
            "total": 889
          },
          "finishReason": "stop",
          "cost": 0.0007656000000000001
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Metrics collection",
          "vars": {
            "user_request": "send custom metrics to Datadog",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 167,
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007656000000000001,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2797067d-6876-4c49-bae6-ca83fec5872a",
        "latencyMs": 29,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: send custom metrics to Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 889,
            "total": 889
          },
          "finishReason": "stop",
          "cost": 0.0007656000000000001
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Metrics collection",
          "vars": {
            "user_request": "send custom metrics to Datadog",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 168,
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007656000000000001,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b4104b0f-beea-453b-a1dd-07f242ae1b93",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: send custom metrics to Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 889,
            "total": 889
          },
          "finishReason": "stop",
          "cost": 0.0007656000000000001
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Metrics collection",
          "vars": {
            "user_request": "send custom metrics to Datadog",
            "expected_agents": "aws-cloud-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 169,
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": "aws-cloud-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007656000000000001,
        "error": "F1: 0.00, Precision: 0.00, Recall: 0.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.75,
          "reason": "F1: 0.00, Precision: 0.00, Recall: 0.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "F1: 0.00, Precision: 0.00, Recall: 0.00 | Expected: [documentation-engineer] | Got: [datadog-specialist, backend-developer, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "35034ffc-d505-46d6-912d-264d849de719",
        "latencyMs": 26,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: send custom metrics to Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 889,
            "total": 889
          },
          "finishReason": "stop",
          "cost": 0.0007656000000000001
        },
        "score": 0.75,
        "success": false,
        "testCase": {
          "description": "Metrics collection",
          "vars": {
            "user_request": "send custom metrics to Datadog",
            "expected_agents": "documentation-engineer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 170,
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": "documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "900ba23c-2c5b-426a-ad2a-6add819c9229",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: centralize logging with Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,aws-cloud-specialist,backend-developer,microservices-architect,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Log aggregation",
          "vars": {
            "user_request": "centralize logging with Datadog",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 171,
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "0481e439-9a8c-47aa-843c-c7663f6594ac",
        "latencyMs": 24,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: centralize logging with Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,aws-cloud-specialist,backend-developer,microservices-architect,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Log aggregation",
          "vars": {
            "user_request": "centralize logging with Datadog",
            "expected_agents": "aws-cloud-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 172,
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": "aws-cloud-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "5d6109b2-784f-4ce2-b10d-5f694e005491",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: centralize logging with Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,aws-cloud-specialist,backend-developer,microservices-architect,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Log aggregation",
          "vars": {
            "user_request": "centralize logging with Datadog",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 173,
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008056000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, aws-cloud-specialist, backend-developer, microservices-architect, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e6c75337-fd5b-4048-8e37-e63306a4df7c",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: centralize logging with Datadog\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,aws-cloud-specialist,backend-developer,microservices-architect,documentation-engineer",
          "tokenUsage": {
            "cached": 899,
            "total": 899
          },
          "finishReason": "stop",
          "cost": 0.0008056000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Log aggregation",
          "vars": {
            "user_request": "centralize logging with Datadog",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 174,
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [datadog-specialist] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "039afdda-9408-414d-a598-118c50eacd39",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: instrument application with OpenTelemetry\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,research-analyst,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "OpenTelemetry setup",
          "vars": {
            "user_request": "instrument application with OpenTelemetry",
            "expected_agents": "datadog-specialist",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 175,
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": "datadog-specialist",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "aea8d5ef-fd1c-4029-add9-b20d7197c800",
        "latencyMs": 20,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: instrument application with OpenTelemetry\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,research-analyst,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "OpenTelemetry setup",
          "vars": {
            "user_request": "instrument application with OpenTelemetry",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 176,
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "af7a1b33-6c6a-417a-991a-de9b2d5f099c",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: instrument application with OpenTelemetry\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,research-analyst,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "OpenTelemetry setup",
          "vars": {
            "user_request": "instrument application with OpenTelemetry",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 177,
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007984000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [research-analyst] | Got: [datadog-specialist, backend-developer, microservices-architect, research-analyst, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "98246b37-6c92-48ac-b170-8fc07221ff1a",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: instrument application with OpenTelemetry\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "datadog-specialist,backend-developer,microservices-architect,research-analyst,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007984000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "OpenTelemetry setup",
          "vars": {
            "user_request": "instrument application with OpenTelemetry",
            "expected_agents": "research-analyst",
            "priority": "MUST"
          },
          "metadata": {
            "category": "metrics-telemetry",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 178,
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": "research-analyst",
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "8d9f8b9f-6081-4140-ac95-41930e2b85ab",
        "latencyMs": 21,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement read model projections from event store\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,python-pro,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Projection implementation",
          "vars": {
            "user_request": "implement read model projections from event store",
            "expected_agents": "eventsourcing-expert",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 179,
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": "eventsourcing-expert",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "7acbd592-5972-4e4c-8b42-aea3f4d29047",
        "latencyMs": 23,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement read model projections from event store\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,python-pro,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Projection implementation",
          "vars": {
            "user_request": "implement read model projections from event store",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 180,
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "c1258a78-0532-4732-82ff-48e8abe764e5",
        "latencyMs": 27,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement read model projections from event store\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,python-pro,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Projection implementation",
          "vars": {
            "user_request": "implement read model projections from event store",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 181,
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008064000000000001,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [eventsourcing-expert, backend-developer, python-pro, microservices-architect, research-analyst]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "efa77abe-32b3-437e-aee0-fb19c8d7c613",
        "latencyMs": 22,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement read model projections from event store\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "eventsourcing-expert,backend-developer,python-pro,microservices-architect,research-analyst",
          "tokenUsage": {
            "cached": 900,
            "total": 900
          },
          "finishReason": "stop",
          "cost": 0.0008064000000000001
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Projection implementation",
          "vars": {
            "user_request": "implement read model projections from event store",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 182,
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008048,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [eventsourcing-expert] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "806a586a-4949-49a8-b164-82dff2aad984",
        "latencyMs": 15,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design domain events for order aggregate\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,eventsourcing-expert,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0008048
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Domain events design",
          "vars": {
            "user_request": "design domain events for order aggregate",
            "expected_agents": "eventsourcing-expert",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 183,
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": "eventsourcing-expert",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008048,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "4a004276-a25c-4f9d-ae45-2bfc03f9ada9",
        "latencyMs": 18,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design domain events for order aggregate\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,eventsourcing-expert,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0008048
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Domain events design",
          "vars": {
            "user_request": "design domain events for order aggregate",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 184,
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008048,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "f2527765-1f60-4921-a3b9-a1d4f412ef01",
        "latencyMs": 18,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design domain events for order aggregate\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,eventsourcing-expert,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0008048
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Domain events design",
          "vars": {
            "user_request": "design domain events for order aggregate",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 185,
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0008048,
        "error": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
        "gradingResult": {
          "pass": false,
          "score": 0.8333333333333334,
          "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [python-pro] | Got: [backend-developer, eventsourcing-expert, microservices-architect, python-pro, documentation-engineer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "0cd9c530-bb5d-4f37-a9fb-c4f177242960",
        "latencyMs": 19,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: design domain events for order aggregate\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,eventsourcing-expert,microservices-architect,python-pro,documentation-engineer",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0008048
        },
        "score": 0.8333333333333334,
        "success": false,
        "testCase": {
          "description": "Domain events design",
          "vars": {
            "user_request": "design domain events for order aggregate",
            "expected_agents": "python-pro",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 186,
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": "python-pro",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [backend-developer] | Got: [backend-developer, microservices-architect, code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested"
            }
          ]
        },
        "id": "670d9808-0a25-4404-ab3b-48ea4fe9b559",
        "latencyMs": 17,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement CQRS pattern for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,microservices-architect,code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "CQRS pattern",
          "vars": {
            "user_request": "implement CQRS pattern for my application",
            "expected_agents": "backend-developer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 187,
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": "backend-developer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [microservices-architect] | Got: [backend-developer, microservices-architect, code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested"
            }
          ]
        },
        "id": "27f5ffef-1ff2-4c5a-b32d-87db47835d82",
        "latencyMs": 17,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement CQRS pattern for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,microservices-architect,code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "CQRS pattern",
          "vars": {
            "user_request": "implement CQRS pattern for my application",
            "expected_agents": "microservices-architect",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 188,
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": "microservices-architect",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [code-reviewer] | Got: [backend-developer, microservices-architect, code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested"
            }
          ]
        },
        "id": "ec34506d-c5e6-416a-a828-a568afe9843f",
        "latencyMs": 17,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement CQRS pattern for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,microservices-architect,code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "CQRS pattern",
          "vars": {
            "user_request": "implement CQRS pattern for my application",
            "expected_agents": "code-reviewer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 189,
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": "code-reviewer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007952,
        "error": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
        "gradingResult": {
          "pass": false,
          "score": 0.5833333333333334,
          "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.33333333333333337,
              "reason": "F1: 0.33, Precision: 0.20, Recall: 1.00 | Expected: [documentation-engineer] | Got: [backend-developer, microservices-architect, code-reviewer, documentation-engineer, research-analyst]"
            },
            {
              "pass": false,
              "score": 0,
              "reason": "PROACTIVE agent eventsourcing-expert should trigger but was not suggested"
            }
          ]
        },
        "id": "e89b4036-07c5-4185-b944-6fa407fdec79",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: implement CQRS pattern for my application\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "backend-developer,microservices-architect,code-reviewer,documentation-engineer,research-analyst",
          "tokenUsage": {
            "cached": 898,
            "total": 898
          },
          "finishReason": "stop",
          "cost": 0.0007952
        },
        "score": 0.5833333333333334,
        "success": false,
        "testCase": {
          "description": "CQRS pattern",
          "vars": {
            "user_request": "implement CQRS pattern for my application",
            "expected_agents": "documentation-engineer",
            "priority": "MUST"
          },
          "metadata": {
            "category": "event-sourcing",
            "expected_strategy": "keyword"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 190,
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": "documentation-engineer",
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007448,
        "error": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.9166666666666666,
          "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.6666666666666666,
              "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "e3632c7e-e949-4fc6-a126-ad769ddfc4f9",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the weather today?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 883,
            "total": 883
          },
          "finishReason": "stop",
          "cost": 0.0007448
        },
        "score": 0.9166666666666666,
        "success": false,
        "testCase": {
          "description": "Completely unrelated request",
          "vars": {
            "user_request": "what's the weather today?",
            "expected_agents": "research-analyst",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 191,
        "vars": {
          "user_request": "what's the weather today?",
          "expected_agents": "research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007448,
        "error": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [research-analyst, aws-cloud-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.9166666666666666,
          "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [research-analyst, aws-cloud-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.6666666666666666,
              "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [aws-cloud-specialist] | Got: [research-analyst, aws-cloud-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "6c941f9c-e8fe-4dea-9a2b-d3c183514d6b",
        "latencyMs": 15,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the weather today?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,aws-cloud-specialist",
          "tokenUsage": {
            "cached": 883,
            "total": 883
          },
          "finishReason": "stop",
          "cost": 0.0007448
        },
        "score": 0.9166666666666666,
        "success": false,
        "testCase": {
          "description": "Completely unrelated request",
          "vars": {
            "user_request": "what's the weather today?",
            "expected_agents": "aws-cloud-specialist",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 192,
        "vars": {
          "user_request": "what's the weather today?",
          "expected_agents": "aws-cloud-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007352000000000001,
        "error": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [claude-specialist] | Got: [claude-specialist, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.9166666666666666,
          "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [claude-specialist] | Got: [claude-specialist, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.6666666666666666,
              "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [claude-specialist] | Got: [claude-specialist, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "2ce30aa5-ae36-40d8-8959-3d9d679d1fee",
        "latencyMs": 14,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tell me a joke\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "claude-specialist,backend-developer",
          "tokenUsage": {
            "cached": 879,
            "total": 879
          },
          "finishReason": "stop",
          "cost": 0.0007352000000000001
        },
        "score": 0.9166666666666666,
        "success": false,
        "testCase": {
          "description": "General conversation",
          "vars": {
            "user_request": "tell me a joke",
            "expected_agents": "claude-specialist",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 193,
        "vars": {
          "user_request": "tell me a joke",
          "expected_agents": "claude-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007352000000000001,
        "error": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [backend-developer] | Got: [claude-specialist, backend-developer]",
        "gradingResult": {
          "pass": false,
          "score": 0.9166666666666666,
          "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [backend-developer] | Got: [claude-specialist, backend-developer]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.6666666666666666,
              "reason": "F1: 0.67, Precision: 0.50, Recall: 1.00 | Expected: [backend-developer] | Got: [claude-specialist, backend-developer]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "d939250d-90de-4d91-9d43-42c0755ac200",
        "latencyMs": 14,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: tell me a joke\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "claude-specialist,backend-developer",
          "tokenUsage": {
            "cached": 879,
            "total": 879
          },
          "finishReason": "stop",
          "cost": 0.0007352000000000001
        },
        "score": 0.9166666666666666,
        "success": false,
        "testCase": {
          "description": "General conversation",
          "vars": {
            "user_request": "tell me a joke",
            "expected_agents": "backend-developer",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 194,
        "vars": {
          "user_request": "tell me a joke",
          "expected_agents": "backend-developer",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007536,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, trend-analyst, claude-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, trend-analyst, claude-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [research-analyst] | Got: [research-analyst, trend-analyst, claude-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "a6995d81-1b05-451d-bdbe-1decefa821e7",
        "latencyMs": 13,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the meaning of life?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,trend-analyst,claude-specialist",
          "tokenUsage": {
            "cached": 886,
            "total": 886
          },
          "finishReason": "stop",
          "cost": 0.0007536
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Non-technical question",
          "vars": {
            "user_request": "what's the meaning of life?",
            "expected_agents": "research-analyst",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 195,
        "vars": {
          "user_request": "what's the meaning of life?",
          "expected_agents": "research-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007536,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [trend-analyst] | Got: [research-analyst, trend-analyst, claude-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [trend-analyst] | Got: [research-analyst, trend-analyst, claude-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [trend-analyst] | Got: [research-analyst, trend-analyst, claude-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "24815eb0-3e25-4de8-8254-e4c9763a9621",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the meaning of life?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,trend-analyst,claude-specialist",
          "tokenUsage": {
            "cached": 886,
            "total": 886
          },
          "finishReason": "stop",
          "cost": 0.0007536
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Non-technical question",
          "vars": {
            "user_request": "what's the meaning of life?",
            "expected_agents": "trend-analyst",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 196,
        "vars": {
          "user_request": "what's the meaning of life?",
          "expected_agents": "trend-analyst",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0.0007536,
        "error": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [claude-specialist] | Got: [research-analyst, trend-analyst, claude-specialist]",
        "gradingResult": {
          "pass": false,
          "score": 0.875,
          "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [claude-specialist] | Got: [research-analyst, trend-analyst, claude-specialist]",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Valid format"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "All agent names are valid"
            },
            {
              "pass": false,
              "score": 0.5,
              "reason": "F1: 0.50, Precision: 0.33, Recall: 1.00 | Expected: [claude-specialist] | Got: [research-analyst, trend-analyst, claude-specialist]"
            },
            {
              "pass": true,
              "score": 1,
              "reason": "PROACTIVE agents correctly handled"
            }
          ]
        },
        "id": "b07f4546-010c-4c4a-9479-b57410f60a43",
        "latencyMs": 16,
        "namedScores": {},
        "prompt": {
          "raw": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: what's the meaning of life?\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n",
          "label": "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
        },
        "promptId": "2b2bff6be4abade518729b48a4403bf19a622d0c147c4da72456cb99ea108b28",
        "promptIdx": 0,
        "provider": {
          "id": "anthropic:claude-3-5-haiku-20241022",
          "label": ""
        },
        "response": {
          "output": "research-analyst,trend-analyst,claude-specialist",
          "tokenUsage": {
            "cached": 886,
            "total": 886
          },
          "finishReason": "stop",
          "cost": 0.0007536
        },
        "score": 0.875,
        "success": false,
        "testCase": {
          "description": "Non-technical question",
          "vars": {
            "user_request": "what's the meaning of life?",
            "expected_agents": "claude-specialist",
            "priority": "NONE"
          },
          "metadata": {
            "category": "no-match",
            "expected_strategy": "none"
          },
          "assert": [
            {
              "type": "javascript",
              "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
            },
            {
              "type": "javascript",
              "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
            },
            {
              "type": "javascript",
              "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
            }
          ],
          "options": {}
        },
        "testIdx": 197,
        "vars": {
          "user_request": "what's the meaning of life?",
          "expected_agents": "claude-specialist",
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none",
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      }
    ],
    "stats": {
      "successes": 0,
      "failures": 198,
      "errors": 0,
      "tokenUsage": {
        "prompt": 0,
        "completion": 0,
        "cached": 177068,
        "total": 177068,
        "numRequests": 198,
        "completionDetails": {
          "reasoning": 0,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      }
    }
  },
  "config": {
    "tags": {},
    "description": "Agent Discovery Hook - LLM Matching Evaluation",
    "prompts": [
      "Analyze this request and suggest 1-5 most relevant agents.\n\nREQUEST: {{user_request}}\n\nAGENTS:\n- api-designer: Expert in RESTful API design, GraphQL, API documentation, versioning, and best practices for scalable API architectures\n- aws-cloud-specialist: PROACTIVE AWS cloud specialist - auto-engages for AWS services, CloudFormation, Lambda, ECS, RDS, S3, IAM, CloudWatch. Validates via Context7 MCP and WebFetch\n- backend-developer: Backend development specialist focused on server-side logic, API design, database integration, and scalable system architecture\n- claude-specialist: Expert in Claude AI API, Anthropic SDKs, prompt engineering, and AI integration best practices\n- code-reviewer: Systematic code review specialist analyzing code quality, best practices, security, performance, and maintainability\n- context-manager: Context window optimization specialist managing token usage, compaction strategies, and conversation efficiency\n- datadog-specialist: PROACTIVE Datadog and observability specialist - auto-engages for Datadog, OpenTelemetry, StatsD, DogStatsD, ddtrace, APM, distributed tracing, metrics collection, log aggregation, observability, monitoring. Validates via Context7 MCP and WebFetch\n- debugger: Debugging specialist skilled in troubleshooting, error analysis, diagnostic techniques, and systematic problem resolution\n- development-orchestrator: PROACTIVE orchestrator for complex multi-phase development workflows requiring 3+ specialized agents with sequential dependencies and quality gates\n- django-developer: Django development specialist with expertise in Django REST Framework, ORM, migrations, and Django best practices\n- documentation-engineer: Technical documentation specialist creating clear, comprehensive documentation including API docs, guides, and technical writing\n- eventsourcing-expert: Expert in Python eventsourcing library. Use proactively when working with event sourcing patterns, aggregates, domain events, event stores, projections, or when eventsourcing library is mentioned\n- github-installation-specialist: PROACTIVE GitHub Apps specialist - auto-engages for GitHub App development, installation authentication, GitHub API integration, webhook handling, and GitHub Apps best practices\n- kubernetes-specialist: Kubernetes specialist expert in container orchestration, deployments, services, scaling, and Kubernetes ecosystem tools\n- microservices-architect: Microservices architecture specialist designing distributed systems, service boundaries, inter-service communication, and resilience patterns\n- postgres-pro: Expert PostgreSQL specialist mastering database administration, performance optimization, and high availability\n- promptfoo-specialist: PROACTIVE promptfoo specialist for LLM testing, prompt evaluation, red teaming, and AI quality assurance\n- python-pro: Python development specialist with deep expertise in Python best practices, patterns, standard library, and ecosystem\n- qa-expert: Quality assurance specialist focused on testing strategies, quality metrics, and comprehensive QA processes\n- research-analyst: PROACTIVE research analyst - auto-engages for documentation lookups, library/framework research, best practices discovery, and comprehensive information gathering\n- task-distributor: Task orchestration specialist coordinating parallel execution of independent tasks across multiple specialized agents\n- test-automator: PROACTIVE test automation specialist - automatically engages when user mentions tests, testing, test automation, test frameworks, test coverage\n- toolkit-manager: PROACTIVE meta-agent for analyzing, improving, and managing the agent/skill toolkit itself\n- trend-analyst: Trend analysis and forecasting specialist identifying patterns, predicting trajectories, and providing strategic insights\n\nCRITICAL: Return ONLY comma-separated agent names (e.g., agent1,agent2) or NONE if unclear.\n\nSTRICT RULES:\n- NO explanations, rationales, or reasoning\n- NO extra text before or after the agent names\n- JUST the comma-separated list, nothing else\n- If unclear, return exactly: NONE\n"
    ],
    "providers": [
      {
        "id": "anthropic:claude-3-5-haiku-20241022",
        "config": {
          "temperature": 0,
          "max_tokens": 100
        }
      }
    ],
    "tests": [
      {
        "description": "PostgreSQL query optimization - clear database request",
        "vars": {
          "user_request": "optimize this PostgreSQL query",
          "expected_agents": [
            "postgres-pro",
            "backend-developer",
            "code-reviewer",
            "research-analyst"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Event sourcing aggregate design",
        "vars": {
          "user_request": "help me design an aggregate for my event sourcing system",
          "expected_agents": [
            "eventsourcing-expert",
            "backend-developer",
            "microservices-architect",
            "python-pro"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Datadog APM tracing setup",
        "vars": {
          "user_request": "set up Datadog APM tracing in my Python app",
          "expected_agents": [
            "datadog-specialist",
            "python-pro",
            "backend-developer",
            "research-analyst"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Test automation framework setup",
        "vars": {
          "user_request": "help me set up automated testing for my application",
          "expected_agents": [
            "test-automator",
            "qa-expert",
            "backend-developer",
            "code-reviewer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API endpoint design",
        "vars": {
          "user_request": "design RESTful API endpoints for user management",
          "expected_agents": [
            "api-designer",
            "backend-developer",
            "documentation-engineer",
            "code-reviewer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Kubernetes deployment configuration",
        "vars": {
          "user_request": "create Kubernetes manifests for my microservice",
          "expected_agents": [
            "kubernetes-specialist",
            "microservices-architect",
            "backend-developer",
            "development-orchestrator"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Python Django application development",
        "vars": {
          "user_request": "build a Django REST API with authentication",
          "expected_agents": [
            "django-developer",
            "backend-developer",
            "api-designer",
            "documentation-engineer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Security vulnerability assessment",
        "vars": {
          "user_request": "audit my application for security vulnerabilities",
          "expected_agents": [
            "qa-expert",
            "code-reviewer",
            "security-specialist",
            "backend-developer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Performance optimization request",
        "vars": {
          "user_request": "my API is slow, help me optimize performance",
          "expected_agents": [
            "backend-developer",
            "aws-cloud-specialist",
            "datadog-specialist",
            "microservices-architect"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Documentation research request",
        "vars": {
          "user_request": "look up documentation for FastAPI async patterns",
          "expected_agents": [
            "research-analyst",
            "backend-developer",
            "documentation-engineer",
            "python-pro"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "clear-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Ambiguous fix request",
        "vars": {
          "user_request": "fix this",
          "expected_agents": [
            "debugger",
            "code-reviewer",
            "research-analyst"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Vague improvement request",
        "vars": {
          "user_request": "make it better",
          "expected_agents": [
            "backend-developer",
            "code-reviewer",
            "documentation-engineer"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Generic help request",
        "vars": {
          "user_request": "help",
          "expected_agents": [
            "research-analyst",
            "backend-developer",
            "documentation-engineer"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Vague check request",
        "vars": {
          "user_request": "check this code",
          "expected_agents": [
            "code-reviewer",
            "debugger",
            "python-pro"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Generic review request",
        "vars": {
          "user_request": "review my work",
          "expected_agents": [
            "code-reviewer",
            "documentation-engineer",
            "research-analyst"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Ambiguous analyze request",
        "vars": {
          "user_request": "analyze this",
          "expected_agents": [
            "research-analyst",
            "context-manager"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "ambiguous-short",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Full stack implementation with testing",
        "vars": {
          "user_request": "implement user registration API with tests and documentation",
          "expected_agents": [
            "backend-developer",
            "test-automator",
            "documentation-engineer",
            "api-designer"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Database schema with event sourcing",
        "vars": {
          "user_request": "design PostgreSQL schema for event sourced aggregates",
          "expected_agents": [
            "postgres-pro",
            "eventsourcing-expert",
            "backend-developer",
            "microservices-architect"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Kubernetes deployment with monitoring",
        "vars": {
          "user_request": "deploy to Kubernetes with Datadog monitoring",
          "expected_agents": [
            "kubernetes-specialist",
            "datadog-specialist",
            "backend-developer",
            "development-orchestrator"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API development with security testing",
        "vars": {
          "user_request": "build REST API with security audit and tests",
          "expected_agents": [
            "api-designer",
            "test-automator",
            "backend-developer",
            "code-reviewer"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "multi-domain",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "How does framework work",
        "vars": {
          "user_request": "how does Django's ORM handle database transactions?",
          "expected_agents": [
            "research-analyst",
            "django-developer",
            "backend-developer",
            "python-pro"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Best practices inquiry",
        "vars": {
          "user_request": "what are best practices for PostgreSQL connection pooling?",
          "expected_agents": [
            "research-analyst",
            "postgres-pro",
            "backend-developer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Documentation lookup",
        "vars": {
          "user_request": "fetch documentation for OpenTelemetry Python SDK",
          "expected_agents": [
            "research-analyst",
            "datadog-specialist",
            "documentation-engineer",
            "python-pro"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Library research",
        "vars": {
          "user_request": "research ddtrace library features",
          "expected_agents": [
            "research-analyst",
            "datadog-specialist",
            "python-pro",
            "documentation-engineer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "API reference lookup",
        "vars": {
          "user_request": "find API reference for Datadog metrics submission",
          "expected_agents": [
            "research-analyst",
            "datadog-specialist",
            "documentation-engineer",
            "backend-developer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "proactive-research",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for monitoring - observability",
        "vars": {
          "user_request": "implement observability for my microservices",
          "expected_agents": [
            "datadog-specialist",
            "microservices-architect",
            "backend-developer",
            "aws-cloud-specialist"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for monitoring - instrumentation",
        "vars": {
          "user_request": "add instrumentation to track request latency",
          "expected_agents": [
            "datadog-specialist",
            "backend-developer",
            "microservices-architect",
            "code-reviewer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Synonym for testing - QA",
        "vars": {
          "user_request": "run quality assurance checks",
          "expected_agents": [
            "test-automator",
            "qa-expert",
            "code-reviewer",
            "development-orchestrator"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-synonym",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - query performance",
        "vars": {
          "user_request": "my database queries are taking too long",
          "expected_agents": [
            "postgres-pro",
            "backend-developer",
            "debugger",
            "datadog-specialist"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - distributed tracing",
        "vars": {
          "user_request": "trace requests across my microservices",
          "expected_agents": [
            "datadog-specialist",
            "microservices-architect",
            "backend-developer",
            "debugger"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Indirect reference - container orchestration",
        "vars": {
          "user_request": "manage my containerized applications at scale",
          "expected_agents": [
            "kubernetes-specialist",
            "aws-cloud-specialist",
            "microservices-architect",
            "development-orchestrator"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "edge-case-indirect",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Typo - postgres vs postgresql",
        "vars": {
          "user_request": "optimize postgres database indexes",
          "expected_agents": [
            "postgres-pro",
            "backend-developer",
            "research-analyst",
            "code-reviewer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Typo - k8s abbreviation",
        "vars": {
          "user_request": "deploy to k8s cluster",
          "expected_agents": [
            "kubernetes-specialist",
            "aws-cloud-specialist",
            "development-orchestrator",
            "backend-developer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "typo",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Common abbreviation - API",
        "vars": {
          "user_request": "build REST API endpoints",
          "expected_agents": [
            "api-designer",
            "backend-developer",
            "documentation-engineer",
            "microservices-architect"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "abbreviation",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Debug production issue with monitoring",
        "vars": {
          "user_request": "debug production error using Datadog traces",
          "expected_agents": [
            "debugger",
            "datadog-specialist",
            "backend-developer",
            "aws-cloud-specialist"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Migration with testing",
        "vars": {
          "user_request": "migrate database schema and ensure tests pass",
          "expected_agents": [
            "postgres-pro",
            "test-automator",
            "backend-developer",
            "development-orchestrator"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Cloud infrastructure setup",
        "vars": {
          "user_request": "set up AWS infrastructure with monitoring and logging",
          "expected_agents": [
            "aws-cloud-specialist",
            "datadog-specialist",
            "development-orchestrator",
            "documentation-engineer"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "complex-scenario",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Django-specific request",
        "vars": {
          "user_request": "create Django models for user authentication",
          "expected_agents": [
            "django-developer",
            "backend-developer",
            "python-pro",
            "code-reviewer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "FastAPI development",
        "vars": {
          "user_request": "build FastAPI application with async endpoints",
          "expected_agents": [
            "python-pro",
            "backend-developer",
            "api-designer",
            "documentation-engineer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "framework-specific",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Error debugging",
        "vars": {
          "user_request": "my application crashes on startup, help debug",
          "expected_agents": [
            "debugger",
            "backend-developer",
            "python-pro",
            "code-reviewer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Test failure debugging",
        "vars": {
          "user_request": "tests are failing, help me fix them",
          "expected_agents": [
            "debugger",
            "test-automator",
            "code-reviewer",
            "qa-expert"
          ],
          "priority": "MULTIPLE"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Performance bottleneck",
        "vars": {
          "user_request": "identify performance bottleneck in my API",
          "expected_agents": [
            "backend-developer",
            "datadog-specialist",
            "debugger",
            "microservices-architect"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "debugging",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Code review request",
        "vars": {
          "user_request": "review this pull request for quality",
          "expected_agents": [
            "code-reviewer",
            "backend-developer",
            "documentation-engineer"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "code-review",
          "expected_strategy": "llm"
        }
      },
      {
        "description": "Documentation writing",
        "vars": {
          "user_request": "write API documentation for these endpoints",
          "expected_agents": [
            "documentation-engineer",
            "api-designer",
            "backend-developer",
            "research-analyst"
          ],
          "priority": "SHOULD"
        },
        "metadata": {
          "category": "documentation",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Metrics collection",
        "vars": {
          "user_request": "send custom metrics to Datadog",
          "expected_agents": [
            "datadog-specialist",
            "backend-developer",
            "aws-cloud-specialist",
            "documentation-engineer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Log aggregation",
        "vars": {
          "user_request": "centralize logging with Datadog",
          "expected_agents": [
            "datadog-specialist",
            "aws-cloud-specialist",
            "backend-developer",
            "microservices-architect"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "OpenTelemetry setup",
        "vars": {
          "user_request": "instrument application with OpenTelemetry",
          "expected_agents": [
            "datadog-specialist",
            "backend-developer",
            "microservices-architect",
            "research-analyst"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "metrics-telemetry",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Projection implementation",
        "vars": {
          "user_request": "implement read model projections from event store",
          "expected_agents": [
            "eventsourcing-expert",
            "backend-developer",
            "python-pro",
            "microservices-architect"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Domain events design",
        "vars": {
          "user_request": "design domain events for order aggregate",
          "expected_agents": [
            "eventsourcing-expert",
            "backend-developer",
            "microservices-architect",
            "python-pro"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "CQRS pattern",
        "vars": {
          "user_request": "implement CQRS pattern for my application",
          "expected_agents": [
            "backend-developer",
            "microservices-architect",
            "code-reviewer",
            "documentation-engineer"
          ],
          "priority": "MUST"
        },
        "metadata": {
          "category": "event-sourcing",
          "expected_strategy": "keyword"
        }
      },
      {
        "description": "Completely unrelated request",
        "vars": {
          "user_request": "what's the weather today?",
          "expected_agents": [
            "research-analyst",
            "aws-cloud-specialist"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      },
      {
        "description": "General conversation",
        "vars": {
          "user_request": "tell me a joke",
          "expected_agents": [
            "claude-specialist",
            "backend-developer"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      },
      {
        "description": "Non-technical question",
        "vars": {
          "user_request": "what's the meaning of life?",
          "expected_agents": [
            "research-analyst",
            "trend-analyst",
            "claude-specialist"
          ],
          "priority": "NONE"
        },
        "metadata": {
          "category": "no-match",
          "expected_strategy": "none"
        }
      }
    ],
    "scenarios": [],
    "env": {},
    "sharing": false,
    "defaultTest": {
      "assert": [
        {
          "type": "javascript",
          "value": "// Response should be agent names or NONE\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\n// Check format: comma-separated names, no extra text\nconst hasExtraText = /[^a-z0-9,\\-_\\s]/i.test(trimmed);\nif (hasExtraText) {\n  return {\n    pass: false,\n    score: 0,\n    reason: 'Response contains invalid characters or extra text'\n  };\n}\n\nconst agents = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst validCount = agents.length >= 1 && agents.length <= 5;\n\nreturn {\n  pass: validCount,\n  score: validCount ? 1 : 0,\n  reason: validCount ? 'Valid format' : `Invalid agent count: ${agents.length}`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const validAgents = [\n  'api-designer', 'aws-cloud-specialist', 'backend-developer', 'claude-specialist',\n  'code-reviewer', 'context-manager', 'datadog-specialist', 'debugger',\n  'development-orchestrator', 'django-developer', 'documentation-engineer',\n  'eventsourcing-expert', 'github-installation-specialist', 'kubernetes-specialist',\n  'microservices-architect', 'postgres-pro', 'promptfoo-specialist', 'python-pro',\n  'qa-expert', 'research-analyst', 'task-distributor', 'test-automator',\n  'toolkit-manager', 'trend-analyst'\n];\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') return { pass: true, score: 1 };\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\nconst invalid = suggested.filter(a => !validAgents.includes(a));\n\nif (invalid.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Invalid agent names: ${invalid.join(', ')}`\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'All agent names are valid' };\n"
        },
        {
          "type": "javascript",
          "value": "// Get expected agents from test metadata\nlet expected = context.vars.expected_agents || [];\n// Ensure expected is always an array\nif (!Array.isArray(expected)) {\n  expected = [expected];\n}\nif (expected.length === 0 || expected[0] === 'NONE') {\n  // For NONE expectations, check that output is NONE\n  const trimmed = output.trim();\n  return {\n    pass: trimmed === 'NONE' || trimmed === '',\n    score: (trimmed === 'NONE' || trimmed === '') ? 1 : 0,\n    reason: trimmed === 'NONE' ? 'Correctly returned NONE' : 'Should have returned NONE'\n  };\n}\n\nconst trimmed = output.trim();\nif (trimmed === 'NONE') {\n  return {\n    pass: false,\n    score: 0,\n    reason: `Expected agents ${expected.join(', ')} but got NONE`\n  };\n}\n\nconst suggested = trimmed.split(',').map(a => a.trim()).filter(a => a);\n\n// Calculate precision, recall, F1\nconst expectedSet = new Set(expected);\nconst suggestedSet = new Set(suggested);\n\nconst truePositives = suggested.filter(a => expectedSet.has(a)).length;\nconst falsePositives = suggested.filter(a => !expectedSet.has(a)).length;\nconst falseNegatives = expected.filter(a => !suggestedSet.has(a)).length;\n\nconst precision = truePositives / (truePositives + falsePositives) || 0;\nconst recall = truePositives / (truePositives + falseNegatives) || 0;\nconst f1 = precision + recall > 0 ? (2 * precision * recall) / (precision + recall) : 0;\n\n// Pass if F1 >= 0.7 (allows some flexibility for multi-agent scenarios)\nconst pass = f1 >= 0.7;\n\nreturn {\n  pass: pass,\n  score: f1,\n  reason: `F1: ${f1.toFixed(2)}, Precision: ${precision.toFixed(2)}, Recall: ${recall.toFixed(2)} | Expected: [${expected.join(', ')}] | Got: [${suggested.join(', ')}]`\n};\n"
        },
        {
          "type": "javascript",
          "value": "const proactiveAgents = {\n  'datadog-specialist': ['datadog', 'observability', 'monitoring', 'metrics', 'telemetry', 'tracing', 'apm', 'opentelemetry', 'instrumentation'],\n  'research-analyst': ['how does', 'how do', 'best practices', 'documentation', 'look up', 'fetch docs', 'research', 'api reference'],\n  'test-automator': ['test', 'testing', 'qa', 'quality', 'coverage'],\n  'aws-cloud-specialist': ['aws', 'cloudformation', 'lambda', 's3', 'rds', 'iam'],\n  'eventsourcing-expert': ['event sourcing', 'aggregate', 'projection', 'domain event', 'cqrs', 'event store'],\n  'promptfoo-specialist': ['promptfoo', 'llm testing', 'prompt evaluation', 'red team'],\n  'toolkit-manager': ['agent', 'skill', 'toolkit']\n};\n\nconst request = (context.vars.user_request || '').toLowerCase();\nconst trimmed = output.trim();\nconst suggested = trimmed === 'NONE' ? [] : trimmed.split(',').map(a => a.trim());\n\nlet violations = [];\nfor (const [agent, triggers] of Object.entries(proactiveAgents)) {\n  const hasTriggered = triggers.some(t => request.includes(t));\n  const wasSuggested = suggested.includes(agent);\n\n  if (hasTriggered && !wasSuggested) {\n    violations.push(`PROACTIVE agent ${agent} should trigger but was not suggested`);\n  }\n}\n\nif (violations.length > 0) {\n  return {\n    pass: false,\n    score: 0,\n    reason: violations.join('; ')\n  };\n}\n\nreturn { pass: true, score: 1, reason: 'PROACTIVE agents correctly handled' };\n"
        }
      ],
      "vars": {},
      "options": {},
      "metadata": {}
    },
    "outputPath": [
      "results/final-test.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {
      "maxConcurrency": 10,
      "cache": true,
      "showProgressBar": true
    }
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.119.9",
    "nodeVersion": "v25.1.0",
    "platform": "darwin",
    "arch": "x64",
    "exportedAt": "2025-11-21T11:56:20.216Z",
    "evaluationCreatedAt": "2025-11-21T11:56:19.471Z"
  }
}